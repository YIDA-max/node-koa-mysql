var D=(B,m,a)=>new Promise((b,g)=>{var _=i=>{try{u(a.next(i))}catch(n){g(n)}},T=i=>{try{u(a.throw(i))}catch(n){g(n)}},u=i=>i.done?b(i.value):Promise.resolve(i.value).then(_,T);u((a=a.apply(B,m)).next())});import{u as k,B as F}from"./useTable.a143d40c.js";import{T as R}from"./TableAction.edf9a202.js";import{e as y}from"./construction.22a3e693.js";import{b as v,r as j,q as z,o as A,c as I,i as S,A as d,D as N,t as V,j as x}from"./index.10ef4608.js";import"./useForm.98d7b8ca.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import"./index.b6ac86eb.js";import"./useAttrs.1d381a3e.js";/* empty css                *//* empty css                */import"./uuid.2429c801.js";import"./index.c8f8ec06.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";/* empty css                */import"./download.66a6d137.js";import"./index.504b494d.js";import"./index.8d0858e7.js";/* empty css               */import"./onMountedOrActivated.0d13b2a6.js";import"./useContentViewHeight.9302814f.js";import"./icon-remark.1929ee0a.js";import"./useSortable.79752a2a.js";/* empty css                */const ge=v({__name:"ExcelDisplay",setup(B){const m=j(0),a=n=>{let e=[...n];const E=[],l=[...e].pop();e.length=e.length-1,e==null||e.forEach(s=>{s[0].forEach(p=>{E.push(p)})});const c=[];return E.forEach((s,p)=>{c.push({title:`${s}`,dataIndex:l[0][p],width:200})}),c},b=n=>(()=>{var C;let e=[...n];const E=[...e].pop();e.length=(e==null?void 0:e.length)-1;const l=[];e==null||e.forEach((r,o)=>{l.push([]),l[o]=r[0]}),e==null||e.forEach(r=>{r.splice(0,1)});let c=0;e==null||e.forEach(r=>{r.length>c&&(c=r.length)}),e==null||e.forEach((r,o)=>{for(let t=0;t<c;t++)e[o][t]||(e[o][t]=[])}),e==null||e.forEach((r,o)=>{e[o].forEach((t,f)=>{var h;if(t.length<l[o].length)for(let w=t.length;w<((h=l[o])==null?void 0:h.length);w++)t.push("")})}),e==null||e.forEach((r,o)=>{e[o].forEach((t,f)=>{t.length>l[o].length&&(t.length=l[o].length)})});const s=[];(C=e[0])==null||C.forEach((r,o)=>{s[o]=[]}),e==null||e.forEach((r,o)=>{r.forEach((t,f)=>{t.length&&t.forEach(h=>{s[f].push(h)})})});const p=[];return s.forEach((r,o)=>{const t={};r.length&&r.forEach((f,h)=>{t[`${E[0][h]}`]=f}),p.push(t)}),p})(),g=()=>{m.value=i().length,console.log(" ",i())},[_,{setColumns:T,setTableData:u,getSelectRows:i}]=k({afterFetch:n=>n,bordered:!0,isTreeTable:!1,striped:!0,showTableSetting:!1,showIndexColumn:!1,canResize:!0,ellipsis:!0,tableSetting:{redo:!0,size:!0,setting:!0,fullScreen:!0},rowSelection:{type:"checkbox"}});return z(()=>D(this,null,function*(){const n=yield y();T(a([...n])),u(b([...n]))})),(n,e)=>(A(),I("div",null,[S(x(F),{onRegister:x(_),onSelectionChange:e[0]||(e[0]=()=>{g()})},{tableTitle:d(()=>[N(" \u5DF2\u79FB\u9664\u7684\u8BB0\u5F55"+V(m.value),1)]),toolbar:d(()=>[]),action:d(()=>[S(x(R),{actions:[{label:"\u67E5\u770B",icon:"ic:outline-delete-outline",onClick:()=>{}},{label:"\u590D\u5236",icon:"ic:outline-delete-outline",onClick:()=>{}}]},null,8,["actions"])]),_:1},8,["onRegister"])]))}});export{ge as default};

var N=(m,I,n)=>new Promise((u,o)=>{var c=t=>{try{f(n.next(t))}catch(p){o(p)}},d=t=>{try{f(n.throw(t))}catch(p){o(p)}},f=t=>t.done?u(t.value):Promise.resolve(t.value).then(c,d);f((n=n.apply(m,I)).next())});import{u as S,c as E,a as L,f as k,b as G}from"./useChangInfo.b588e1ad.js";import{b as R,F as b,u as T,r as V,l as x,j as e,ay as H,s as U,q as O,x as j,o as y,U as v,A as i,i as r,I as g,f as D,D as q,t as $,a1 as z,G as J}from"./index.10ef4608.js";/* empty css              *//* empty css               */import{u as K}from"./useCountDown.23082dea.js";import"./index.3b12af83.js";const ae=R({__name:"ChangeEmailForm",props:{info:{type:String,default:""}},setup(m,{expose:I}){const n=m,u=b.Item,{t:o}=T(),c=V(),{getChangeState:d}=S(),f=x(()=>[E.CHANGE_BIND_EMAIL,E.CHANGE_EMAIL].includes(e(d)));H(()=>n.info,(s,a)=>{l.oldEmail=s});const{countDownFn:t,countDown:p,BtnDisabled:w}=K("CHANGE_BIND_EMAIL"),l=U({oldEmail:"",newEmail:"",code:""}),{getFormRules:F}=L(l),{validForm:A}=G(c),{createMessage:M}=J(),h=()=>N(this,null,function*(){try{if(!(yield A(["newEmail"])))return!1;t();const a={id:"",to:""};e(d)===E.CHANGE_BIND_EMAIL?(a.id="UNTIE_EMAIL_VERIFICATION",a.to=l.newEmail):e(d)===E.CHANGE_EMAIL&&(a.id="RESET_BIND_EMAIL_VERIFICATION",a.to=l.newEmail);const C=yield z(a);M.success(o(C.msg))}catch(s){}});function B(){var s;(s=e(c))==null||s.resetFields()}return O(()=>{localStorage.getItem("CHANGE_BIND_EMAIL")&&t()}),I({validForm:A,formData:l,claerForm:B}),(s,a)=>{const C=j("CustomButton");return e(f)?(y(),v(e(b),{key:0,model:l,rules:e(F),ref_key:"formRef",ref:c,"label-col":{span:4},"wrapper-col":{span:20}},{default:i(()=>[m.info?(y(),v(e(u),{key:0,name:"oldEmail",label:e(o)("sys.login.oldEmail")},{default:i(()=>[r(e(g),{value:e(k)(m.info,"email"),disabled:"",autocomplete:""},null,8,["value"])]),_:1},8,["label"])):D("v-if",!0),r(e(u),{name:"newEmail",label:e(o)("sys.login.newEmail")},{default:i(()=>[r(e(g),{value:l.newEmail,"onUpdate:value":a[0]||(a[0]=_=>l.newEmail=_),placeholder:e(o)("sys.login.placeNewEmail"),autocomplete:""},null,8,["value","placeholder"])]),_:1},8,["label"]),r(e(u),{name:"code",label:e(o)("sys.login.emailCode")},{default:i(()=>[r(e(g),{value:l.code,"onUpdate:value":a[1]||(a[1]=_=>l.code=_),placeholder:e(o)("sys.login.placeEmailCode"),autocomplete:""},{suffix:i(()=>[r(C,{onClick:h,btnStyle:{height:"auto",padding:0,color:"#2f54eb",background:"#fff !important",border:"none"},disabled:e(w)},{default:i(()=>[q($(e(w)?`${e(p)}s`:e(o)("sys.login.getCode")),1)]),_:1},8,["disabled"])]),_:1},8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])):D("v-if",!0)}}});export{ae as default};

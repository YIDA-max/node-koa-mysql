import{u as S,B as y}from"./index-b6b4562f.js";import{u as M,a as b}from"./useForm-f3f06b26.js";import{_ as k}from"./index-0737cab3.js";import{d as B}from"./role.data-ef05ba06.js";import{g as D,u as F,c as C}from"./index-7210d183.js";import{l as U}from"./index-99ee5a1a.js";import{h as L}from"./tree-56b28626.js";import{a as p,H as n,u as e,o as P,c as $,w as c,e as m,ag as x}from"./index-4a8cc517.js";const I=p({name:"SystemRoleScopeModal"}),q=p({...I,emits:["success","register"],setup(N,{emit:u}){const t=n(!0),o=n([]),[d,{setFieldsValue:f,resetFields:_,validate:g}]=M({labelWidth:120,baseColProps:{span:24},schemas:B,showActionButtonGroup:!1,actionColOptions:{span:23}}),[h,{setModalProps:r,closeModal:v}]=S(async a=>{if(_(),r({confirmLoading:!1}),e(o).length===0){const s=await U();o.value=L(s,"id")}if(t.value=!!a?.isUpdate,e(t)){const s=await D(a.record.id);f({...s})}});async function w(){try{const a=await g();r({confirmLoading:!0}),e(t)?await F(a):await C(a),v(),u("success")}finally{r({confirmLoading:!1})}}return(a,s)=>(P(),$(e(y),x(a.$attrs,{onRegister:e(h),title:t.value?"编辑":"新增",onOk:w}),{default:c(()=>[m(e(b),{onRegister:e(d)},{dataScopeDeptIds:c(({model:i,field:l})=>[m(e(k),{value:i[l],"onUpdate:value":R=>i[l]=R,treeData:o.value,fieldNames:{title:"name",key:"id"},checkable:"",toolbar:"",title:"部门分配"},null,8,["value","onUpdate:value","treeData"])]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{q as _};

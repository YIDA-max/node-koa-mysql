var f=(c,r,t)=>new Promise((n,a)=>{var u=l=>{try{i(t.next(l))}catch(m){a(m)}},d=l=>{try{i(t.throw(l))}catch(m){a(m)}},i=l=>l.done?n(l.value):Promise.resolve(l.value).then(u,d);i((t=t.apply(c,r)).next())});import{u as C,B as S}from"./useForm.98d7b8ca.js";import{u as _,b as F,r as w,l as N,j as o,o as T,U,A as g,i as P,B as V,G as j}from"./index.10ef4608.js";import{a as A,B as G}from"./index.8dc2742f.js";import{_ as M}from"./Tree.vue_vue_type_style_index_0_lang.ee074416.js";import{e as O,s as $}from"./roles.32b28635.js";const{t:e}=_(),Q=[{title:e("system.role.roleName"),dataIndex:"name",width:200},{title:e("system.role.roleValue"),dataIndex:"code",width:180},{title:e("system.role.order"),dataIndex:"sort",width:50},{title:e("system.role.status"),width:120,slots:{customRender:"status"},dataIndex:"enable"},{title:e("system.role.createTime"),dataIndex:"createTime",width:180},{title:e("system.role.remark"),dataIndex:"remark"}],X=[{field:"name",label:e("system.role.roleName"),component:"Input",colProps:{span:6},componentProps({tableAction:c,formModel:r}){return{onChange(t){const{reload:n}=c;!t.target.value&&t.type==="click"&&(r.name="",n())}}}},{field:"enable",label:e("system.role.status"),component:"Select",componentProps:{allowClear:"allowClear",options:[{label:e("system.role.enable"),value:"1"},{label:e("system.role.disable"),value:"0"}]},colProps:{span:6}},{field:"times",label:e("system.role.createTime"),component:"RangePicker",colProps:{span:6}}],q=[{label:e("system.role.roleName"),field:"name",labelWidth:"90px",required:!0,component:"Input",componentProps:{maxlength:20}},{label:e("system.role.roleValue"),field:"code",required:!0,component:"Input",componentProps:{maxlength:20}},{label:e("system.role.status"),field:"enable",component:"RadioButtonGroup",defaultValue:!0,componentProps:{options:[{label:e("system.role.enable"),value:!0},{label:e("system.role.disable"),value:!1}]},colProps:{span:12}},{label:e("system.role.sort"),field:"sort",component:"InputNumber",colProps:{span:12}},{label:e("system.role.remark"),field:"remark",component:"InputTextArea"},{label:"id",field:"id",component:"Input",show:!1}],L=F({__name:"RoleDrawer",emits:["success","register"],setup(c,{emit:r}){const{t}=_(),n=["admin","user","manage"],a=w(!0),u=w([]),d=N(()=>o(a)?t("system.role.editRole"):t("system.role.addRole")),[i,{resetFields:l,setFieldsValue:m,validate:v,updateSchema:I}]=C({labelWidth:90,baseColProps:{span:24},schemas:q,showActionButtonGroup:!1}),[R,{setDrawerProps:b,closeDrawer:x}]=A(s=>f(this,null,function*(){var p;l(),a.value=!!(s!=null&&s.isUpdate),o(a)&&m(s.record),I([{field:"code",componentProps:{disabled:o(a)}},{field:"enable",componentProps:{disabled:n.includes((p=s==null?void 0:s.record)==null?void 0:p.code)}}])})),{createMessage:k}=j();function D(){return f(this,null,function*(){try{const s=yield v();b({confirmLoading:!0}),o(a)?yield O(s):yield $(s),x(),r("success"),k.success(t(`system.role.role${o(a)?"Edit":"Create"}Success`))}finally{b({confirmLoading:!1})}})}return(s,p)=>(T(),U(o(G),V(s.$attrs,{onRegister:o(R),showFooter:"",title:o(d),width:"500px",onOk:D}),{default:g(()=>[P(o(S),{onRegister:o(i)},{menu:g(({model:y,field:h})=>[P(o(M),{value:y[h],"onUpdate:value":B=>y[h]=B,treeData:u.value,fieldNames:{title:"menuName",key:"id"},checkable:"",title:o(t)("system.role.menuDistribution")},null,8,["value","onUpdate:value","treeData","title"])]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"]))}});var Y=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}));export{Y as R,L as _,Q as c,X as s};

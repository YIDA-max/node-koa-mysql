var f=(g,m,o)=>new Promise((p,a)=>{var l=e=>{try{s(o.next(e))}catch(t){a(t)}},c=e=>{try{s(o.throw(e))}catch(t){a(t)}},s=e=>e.done?p(e.value):Promise.resolve(e.value).then(l,c);s((o=o.apply(g,m)).next())});import{b as y,B as _}from"./index.c8f8ec06.js";import{u as M,B as S}from"./useTable.a143d40c.js";import"./TableAction.edf9a202.js";import{g as k}from"./roles.32b28635.js";import{f as x,h as B,i as C}from"./users.30d9a1d7.js";import{b as I,u as L,o as T,U as K,A as P,i as U,j as n,G as A}from"./index.10ef4608.js";import"./useAttrs.1d381a3e.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";import"./useForm.98d7b8ca.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import"./index.b6ac86eb.js";/* empty css                *//* empty css                */import"./uuid.2429c801.js";/* empty css                */import"./download.66a6d137.js";import"./index.504b494d.js";import"./index.8d0858e7.js";/* empty css               */import"./onMountedOrActivated.0d13b2a6.js";import"./useContentViewHeight.9302814f.js";import"./icon-remark.1929ee0a.js";import"./useSortable.79752a2a.js";/* empty css                */import"./index.3b12af83.js";const fe=I({__name:"DispatchModal",emits:["success","register"],setup(g,{emit:m}){const{t:o}=L(),{createMessage:p}=A(),[a,{getSelectRowKeys:l,setSelectedRowKeys:c,setProps:s}]=M({api:k,columns:C,bordered:!0,clickToRowSelect:!1,pagination:!1,canResize:!0,rowSelection:{type:"checkbox"},rowKey:"id",showIndexColumn:!1});let e=null;const[t,{closeModal:w,setModalProps:d}]=y(r=>f(this,null,function*(){d({confirmLoading:!1}),e=r.record.id;const u=yield x(r.record.id),b=u.map(i=>i.id),h=u.find(i=>i.code==="user");c([...new Set([...b])]),s({rowSelection:{getCheckboxProps:i=>({disabled:i.code===h.code})}})})),R=()=>f(this,null,function*(){try{const r=l();d({confirmLoading:!0}),yield B({userId:e,roleIds:r}),p.success(o("system.user.roleAssignmentSucceeded"))}finally{w(),c([]),m("success"),d({confirmLoading:!1})}});return(r,u)=>(T(),K(n(_),{onRegister:n(t),onOk:R,title:"\u5206\u914D\u6743\u9650"},{default:P(()=>[U(n(S),{onRegister:n(a)},null,8,["onRegister"])]),_:1},8,["onRegister"]))}});export{fe as default};

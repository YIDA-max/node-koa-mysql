var T=Object.defineProperty;var h=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var M=(r,a,e)=>a in r?T(r,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[a]=e,_=(r,a)=>{for(var e in a||(a={}))U.call(a,e)&&M(r,e,a[e]);if(h)for(var e of h(a))z.call(a,e)&&M(r,e,a[e]);return r};var d=(r,a,e)=>new Promise((l,o)=>{var F=i=>{try{p(e.next(i))}catch(f){o(f)}},m=i=>{try{p(e.throw(i))}catch(f){o(f)}},p=i=>i.done?l(i.value):Promise.resolve(i.value).then(F,m);p((e=e.apply(r,a)).next())});import{b as L,B as W}from"./index.c8f8ec06.js";import{u as $,B as H}from"./useForm.98d7b8ca.js";import{a as J,b as K,u as Q,r as E,l as X,j as t,x as Y,o as j,U as A,A as v,e as Z,i as P,D as N,t as x,f as ee,B as ae,aT as te,G as se}from"./index.10ef4608.js";import{q as D,c as re,d as oe}from"./record.74637501.js";import"./useAttrs.1d381a3e.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import"./index.b6ac86eb.js";/* empty css                *//* empty css                */import"./uuid.2429c801.js";import"./TableAction.edf9a202.js";/* empty css                */import"./download.66a6d137.js";import"./index.504b494d.js";const ie={class:"flex justify-end"},ce=K({__name:"addOrEditOrViewModal",props:{success:{type:Function,required:!0}},setup(r){const a=r,{t:e}=Q(),{createMessage:l}=se(),o=E("add"),F=X(()=>t(o)==="add"?e("AllMessage.cmAdd"):t(o)==="edit"?e("AllMessage.cmEdit"):e("AllMessage.cmView")),m=E(),[p,{closeModal:i}]=L(u=>d(this,[u],function*({statusText:c,record:s}){const n=w=>d(this,null,function*(){yield S([{field:"projectName",component:"Input",label:e("cm.masterProject.mainProjectName"),rules:w,componentProps:({formActionType:R,formModel:q})=>({onBlur:te(()=>d(this,null,function*(){try{const{updateSchema:B,validate:I}=R,O={name:c==="add"?"":m.value.projectName,status:c==="add",names:q.projectName},G=yield D(O);yield B({field:"projectName",rules:[{validator:()=>G?Promise.resolve():Promise.reject("\u5DF2\u5B58\u5728"),required:!0}]}),yield I(["projectName"])}catch(B){console.error(B)}}),100)}),colProps:{span:24}}])});switch(g(),o.value=c,m.value=s,c){case"edit":yield n([{required:!0,message:"\u8BF7\u8F93\u5165\u4E3B\u9879\u76EE\u540D\u79F0"}]),b({disabled:!1}),setTimeout(()=>{y(_({},s))});break;case"view":yield n([]),y(_({},s)),b({disabled:!0});break;case"add":yield n([{required:!0,message:"\u8BF7\u8F93\u5165\u4E3B\u9879\u76EE\u540D\u79F0"}]),b({disabled:!1});break}})),[f,{resetFields:g,getFieldsValue:C,setFieldsValue:y,validate:k,updateSchema:S,setProps:b}]=$({showActionButtonGroup:!1,labelWidth:80,disabled:!1,schemas:[{field:"projectName",component:"Input",label:e("cm.masterProject.mainProjectName"),colProps:{span:24},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4E3B\u9879\u76EE\u540D\u79F0"},{validator:(c,s)=>d(this,null,function*(){return new Promise((u,n)=>{D({name:"",status:!0,names:s}).then(w=>{w?u():n("\u5DF2\u5B58\u5728")}).catch(()=>{n("\u5DF2\u5B58\u5728")})})}),validateTrigger:"blur"}]},{field:"projectDescribe",component:"InputTextArea",label:e("cm.masterProject.projectDescribe"),componentProps:{autoSize:{minRows:4,maxRows:5},placeholder:"\u8BF7\u8F93\u5165\u63CF\u8FF0",rows:8},colProps:{span:24}}]}),V=()=>d(this,null,function*(){try{if(!(yield k()))return;const s=C();if(t(o)==="add"){const u=yield re(s);u.code===200?l.success(e("AllMessage.successAdd")):l.error(u.msg),a.success()}else if(t(o)==="edit"){s.id=m.value.id;const u=yield oe(s);u.code===200?l.success(e("AllMessage.successEdit")):l.error(u.msg),a.success()}i(),g()}catch(c){console.error(c)}finally{}});return(c,s)=>{const u=Y("CustomButton");return j(),A(t(W),ae(c.$attrs,{onRegister:t(p),title:t(F)}),{footer:v(()=>[Z("div",ie,[P(u,{btnStyle:{backgroundColor:"#fff",border:"1px solid rgb(102, 102, 102)",padding:"0px 20px",color:"#000",marginLeft:"10px"},onClick:s[0]||(s[0]=()=>{t(g)(),o.value=="view"?function(){t(i)()}():function(){t(g)()}()})},{default:v(()=>[N(x(o.value=="view"?t(e)("AllMessage.cancel"):t(e)("AllMessage.reset")),1)]),_:1},8,["btnStyle"]),o.value!=="view"?(j(),A(u,{key:0,btnStyle:{backgroundColor:"#2F54EB",padding:"0px 20px",color:"#fff"},onClick:V},{default:v(()=>[N(x(t(e)("AllMessage.confirm")),1)]),_:1})):ee("v-if",!0)])]),default:v(()=>[P(t(H),{onRegister:t(f),ref:"basicForm"},null,8,["onRegister"])]),_:1},16,["onRegister","title"])}}});var De=J(ce,[["__scopeId","data-v-38a9d3ec"]]);export{De as default};

import{u as x,B as w}from"./index-b6b4562f.js";import{u as R,a as C}from"./useForm-f3f06b26.js";import{bD as r,be as a,l as L,a as u,H as y,u as i,o as S,c as b,w as U,e as Y,ag as M}from"./index-4a8cc517.js";import{g as O}from"./index-088d6a2f.js";import"./index-1ec106fd.js";import{u as T}from"./useRender-3355e2aa.js";import{P as n}from"./systemEnum-97385b69.js";import{g as m,D as f}from"./dict-9afd743e.js";import{T as o}from"./index-878008b6.js";import{S as W}from"./index-328db71b.js";function J(e){return r.get({url:"/pay/app/page",params:e})}function B(e){return r.get({url:"/pay/app/get?id="+e})}function X(e){return r.post({url:"/pay/app/create",data:e})}function k(e){return r.put({url:"/pay/app/update",data:e})}function N(e){return r.put({url:"/pay/app/update-status",data:e})}function K(e){return r.delete({url:"/pay/app/delete?id="+e})}function Z(e){return r.download({url:"/pay/app/export-excel",params:e},"支付应用.xls")}const ee=[{title:"应用编号",dataIndex:"id",width:100},{title:"应用名",dataIndex:"name",width:100},{title:"开启状态",dataIndex:"status",width:100,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),a(W,{checked:e.status===0,checkedChildren:"已启用",unCheckedChildren:"已禁用",loading:e.pendingStatus,onChange(t){e.pendingStatus=!0;const s=t?0:1,{createMessage:c}=L();N({id:e.id,status:s}).then(()=>{e.status=s,c.success("已成功修改应用状态")}).catch(()=>{c.error("修改应用状态失败")}).finally(()=>{e.pendingStatus=!1})}}))},{title:"商户名称",dataIndex:"payMerchant.name",width:100,customRender:({record:e})=>e.payMerchant.name||""},{title:"支付宝配置",children:[{title:n.ALIPAY_APP.name,dataIndex:n.ALIPAY_APP.code,width:160,customRender:({record:e})=>{const t=e.channelCodes.indexOf(n.ALIPAY_APP.code)!==-1;return a(o,{color:t?"#108ee9":"#f50000"},()=>t?"已设置":"未设置")}},{title:n.ALIPAY_PC.name,dataIndex:n.ALIPAY_PC.code,width:160,customRender:({record:e})=>{const t=e.channelCodes.indexOf(n.ALIPAY_PC.code)!==-1;return a(o,{color:t?"#108ee9":"#f50000"},()=>t?"已设置":"未设置")}},{title:n.ALIPAY_WAP.name,dataIndex:n.ALIPAY_WAP.code,width:160,customRender:({record:e})=>{const t=e.channelCodes.indexOf(n.ALIPAY_WAP.code)!==-1;return a(o,{color:t?"#108ee9":"#f50000"},()=>t?"已设置":"未设置")}},{title:n.ALIPAY_QR.name,dataIndex:n.ALIPAY_QR.code,width:160,customRender:({record:e})=>{const t=e.channelCodes.indexOf(n.ALIPAY_QR.code)!==-1;return a(o,{color:t?"#108ee9":"#f50000"},()=>t?"已设置":"未设置")}},{title:n.ALIPAY_BAR.name,dataIndex:n.ALIPAY_BAR.code,width:160,customRender:({record:e})=>{const t=e.channelCodes.indexOf(n.ALIPAY_BAR.code)!==-1;return a(o,{color:t?"#108ee9":"#f50000"},()=>t?"已设置":"未设置")}}]},{title:"微信配置",children:[{title:n.WX_LITE.name,dataIndex:n.WX_LITE.code,width:160,customRender:({record:e})=>{const t=e.channelCodes.indexOf(n.WX_LITE.code)!==-1;return a(o,{color:t?"#108ee9":"#f50000"},()=>t?"已设置":"未设置")}},{title:n.WX_PUB.name,dataIndex:n.WX_PUB.code,width:160,customRender:({record:e})=>{const t=e.channelCodes.indexOf(n.WX_PUB.code)!==-1;return a(o,{color:t?"#108ee9":"#f50000"},()=>t?"已设置":"未设置")}},{title:n.WX_APP.name,dataIndex:n.WX_APP.code,width:160,customRender:({record:e})=>{const t=e.channelCodes.indexOf(n.WX_APP.code)!==-1;return a(o,{color:t?"#108ee9":"#f50000"},()=>t?"已设置":"未设置")}}]},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:e})=>T.renderDate(e)}],te=[{label:"应用名",field:"name",component:"Input",colProps:{span:8}},{label:"商户名称",field:"merchantName",component:"Input",colProps:{span:8}},{label:"开启状态",field:"status",component:"Select",componentProps:{options:m(f.COMMON_STATUS)},colProps:{span:8}},{label:"创建时间",field:"createTime",component:"RangePicker",colProps:{span:8}}],F=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"应用名",field:"name",required:!0,component:"Input"},{label:"所属商户",field:"shortName",required:!0,component:"ApiSelect",componentProps:{api:()=>O(""),labelField:"name",valueField:"id"}},{label:"开启状态",field:"status",component:"Select",defaultValue:0,componentProps:{options:m(f.COMMON_STATUS)}},{label:"支付结果的回调地址",field:"payNotifyUrl",required:!0,component:"Input"},{label:"退款结果的回调地址",field:"refundNotifyUrl",required:!0,component:"Input"},{label:"备注",field:"remark",component:"InputTextArea"}],v=u({name:"PayAppModal"}),ne=u({...v,emits:["success","register"],setup(e,{emit:t}){const s=y(!0),[c,{setFieldsValue:A,resetFields:P,validate:h}]=R({labelWidth:120,baseColProps:{span:24},schemas:F,showActionButtonGroup:!1,actionColOptions:{span:23}}),[I,{setModalProps:l,closeModal:_}]=x(async d=>{if(P(),l({confirmLoading:!1}),s.value=!!d?.isUpdate,i(s)){const p=await B(d.record.id);A({...p})}});async function g(){try{const d=await h();l({confirmLoading:!0}),i(s)?await k(d):await X(d),_(),t("success")}finally{l({confirmLoading:!1})}}return(d,p)=>(S(),b(i(w),M(d.$attrs,{onRegister:i(I),title:s.value?"编辑":"新增",onOk:g}),{default:U(()=>[Y(i(C),{onRegister:i(c)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{ne as _,ee as c,K as d,Z as e,J as g,te as s};

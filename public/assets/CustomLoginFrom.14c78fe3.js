var $=(b,n,c)=>new Promise((g,f)=>{var I=l=>{try{r(c.next(l))}catch(u){f(u)}},D=l=>{try{r(c.throw(l))}catch(u){f(u)}},r=l=>l.done?g(l.value):Promise.resolve(l.value).then(I,D);r((c=c.apply(b,n)).next())});import{a as z,b as O,u as q,l as W,j as e,F as x,r as L,m as H,n as J,q as Q,s as X,v as Y,w as Z,x as ee,y as E,z as F,o as oe,c as te,i as s,A as m,B as M,I as R,C as ae,D as U,t as S,f as se,e as k,E as A,G as ne}from"./index.10ef4608.js";/* empty css              *//* empty css               *//* empty css               */import{u as re,L as h}from"./useCustomLogin.887e5231.js";import{e as j,L as le}from"./myMitt.c3f6feaa.js";import{E as t,D as T}from"./aes.1609b06a.js";import ue from"./CustomTitle.fe89c51d.js";import"./index.3b12af83.js";import"./mitt.550594b0.js";const ie={class:"login-form enter-x"},me={class:"reset flex justify-between items-center"},de=O({__name:"CustomLoginFrom",setup(b){const{t:n}=q(),{getLoginState:c,setLoginState:g}=re(),f=W(()=>e(c)===h.LOGIN),{notification:I,createErrorModal:D}=ne(),r=x.Item,l=x.useForm,u=L(!1);H(()=>{j.on("clearLoginForm",P)}),J(()=>{j.off("clearLoginForm",P)}),Q(()=>{p.value?u.value=!0:V()});const V=()=>{let d=0;const o=setInterval(()=>{d+=1,a.username="",a.password="",document.getElementById("username").value="",document.getElementById("password").value="",d>8&&(u.value=!0,clearInterval(o))},100)},a=X({username:"",password:""}),v="username",w="password",_="isSave",p=L(window.localStorage.getItem(t(_))||!1),B=L(!1),G=Y();if(Z("login"),window.localStorage.getItem(t(v))&&window.localStorage.getItem(t(w))){const d=window.localStorage.getItem(t(v))||"",o=window.localStorage.getItem(t(w))||"";a.username=T(d),a.password=T(o)}const{validate:C,validateInfos:N,resetFields:P}=l(a,le),y=()=>$(this,null,function*(){try{if(!(yield C()))return;B.value=!0;const o=yield G.customLogin({username:t(a.username),password:t(a.password)});o&&I.success({message:n("Notification.loginSuccessfully"),description:`${n("Notification.welcomeBack")}: ${o.nickname}`,duration:3})}catch(d){}finally{B.value=!1,p.value?(window.localStorage.setItem(t(v),t(a.username)),window.localStorage.setItem(t(w),t(a.password)),window.localStorage.setItem(t(_),t(!0))):(window.localStorage.removeItem(t(v)),window.localStorage.removeItem(t(w)),window.localStorage.removeItem(t(_)))}});return(d,o)=>{const K=ee("CustomButton");return E((oe(),te("div",ie,[s(ue),s(e(x),null,{default:m(()=>[s(e(r),M({name:"username"},e(N).username),{default:m(()=>[E(s(e(R),{placeholder:e(n)("login.placeAccount"),onPressEnter:y,id:"username",name:"username",autocomplete:"off",value:a.username,"onUpdate:value":o[0]||(o[0]=i=>a.username=i),type:"text",autofocus:"",onBlur:o[1]||(o[1]=i=>e(C)("username",{trigger:"blur"}).catch(()=>{}))},null,8,["placeholder","value"]),[[F,u.value]])]),_:1},16),s(e(r),M({name:"password"},e(N).password),{default:m(()=>[E(s(e(R),{type:"password",id:"password",name:"password",autocomplete:"off",placeholder:e(n)("login.placePwd"),value:a.password,"onUpdate:value":o[2]||(o[2]=i=>a.password=i),maxLength:"20",onPressEnter:y,onBlur:o[3]||(o[3]=i=>e(C)("password",{trigger:"blur"}).catch(()=>{}))},null,8,["placeholder","value"]),[[F,u.value]])]),_:1},16),s(e(r),{name:"remember"},{default:m(()=>[s(e(ae),{checked:p.value,onClick:o[4]||(o[4]=i=>p.value=!p.value)},{default:m(()=>[U(S(e(n)("login.saveMe")),1)]),_:1},8,["checked"])]),_:1}),s(e(r),{name:"loginBtn"},{default:m(()=>[s(K,{btnStyle:{width:"460px",height:"60px",background:"#2F54EB",borderRadius:"4px",fontSize:"20px",textAlign:"center"},loading:B.value,onClick:y},{default:m(()=>[U(S(e(n)("login.login")),1)]),_:1},8,["loading"])]),_:1}),se(" \u5FD8\u8BB0\u5BC6\u7801\u3001\u7ACB\u5373\u6CE8\u518C "),s(e(r),{name:"reset"},{default:m(()=>[k("div",me,[k("a",{href:"javascript:;",onClick:o[5]||(o[5]=A(i=>e(g)(e(h).RESET_PASSWORD),["prevent"]))},S(e(n)("login.forgetPwd")),1),k("a",{href:"javascript:;",onClick:o[6]||(o[6]=A(i=>e(g)(e(h).REGISTER),["prevent"]))},S(e(n)("login.register")),1)])]),_:1})]),_:1})],512)),[[F,u.value&&e(f)]])}}});var ye=z(de,[["__scopeId","data-v-75368e9d"]]);export{ye as default};

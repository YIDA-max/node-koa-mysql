var g=(S,d,v)=>new Promise((_,D)=>{var P=x=>{try{T(v.next(x))}catch(w){D(w)}},C=x=>{try{T(v.throw(x))}catch(w){D(w)}},T=x=>x.done?_(x.value):Promise.resolve(x.value).then(P,C);T((v=v.apply(S,d)).next())});import{a as Ae,b as Oe,u as De,cJ as Me,aw as je,r as b,l as W,q as Be,x as K,o as y,c as I,i as h,A as c,e as f,t as u,j as l,ao as $e,ap as We,U as A,y as N,z as k,ab as fe,D as F,I as he,d5 as me,f as L,p as Ke,k as Le,G as Ve}from"./index.10ef4608.js";import{u as ge,B as be}from"./useTable.a143d40c.js";import"./TableAction.edf9a202.js";import{P as Je}from"./index.8d0858e7.js";import{e as O,q as V,h as ze}from"./homePage.0537fe58.js";import{A as qe}from"./index.c279c358.js";import{s as Ue}from"./supportingPaper.267f0f46.js";import{d as He,a as Ge,b as Qe}from"./homePage.c3e9252e.js";import{C as J}from"./index.866ec2c8.js";import"./useForm.98d7b8ca.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import"./index.b6ac86eb.js";import"./useAttrs.1d381a3e.js";/* empty css                *//* empty css                */import"./uuid.2429c801.js";import"./index.c8f8ec06.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";/* empty css                */import"./download.66a6d137.js";import"./index.504b494d.js";import"./icon-remark.1929ee0a.js";import"./onMountedOrActivated.0d13b2a6.js";import"./useSortable.79752a2a.js";/* empty css                *//* empty css               */import"./useContentViewHeight.9302814f.js";import"./modal-error.7cada6d5.js";const Xe=S=>(Ke("data-v-d5fd7c22"),S=S(),Le(),S),Ye={class:"bg-white px-5 py-3"},Ze={class:"flex items-center mb-2"},ea=Xe(()=>f("div",{class:"w-[5px] h-4 bg-primary"},null,-1)),aa={class:"text-base font-333 ml-2"},oa={style:{},class:"px-5"},ta={style:{position:"relative"}},sa={style:{position:"absolute",left:"45%",bottom:"-1px"}},la={key:0,style:{textIndent:"0"}},na={key:1},ia={style:{textAlign:"right"}},ra={style:{textAlign:"left"}},da={style:{position:"relative"}},ca={style:{position:"absolute",bottom:"-1px",left:"45%"}},ua={key:0,style:{textIndent:"0"}},pa={key:1},fa={style:{textAlign:"left"}},ha={style:{textAlign:"left"}},ma={style:{textAlign:"left"}},ga=Oe({__name:"index",setup(S){const{t:d}=De(),{hasPermission:v}=Me(),{createMessage:_}=Ve(),D=je(),P=Ue(),C=b("2"),T=b(),x=b([]),w=b(""),z=b(""),R=b([]),E=b([]),M=b([]),ye=W(()=>{const n=JSON.parse(JSON.stringify(M.value));let e=0;return n.forEach(a=>{a.fileMd5&&e++}),e}),j=b([]),xe=W(()=>{const n=JSON.parse(JSON.stringify(j.value));let e=0;return n.forEach(a=>{a.fileMd5&&e++}),e}),B=b([]),oe=W(()=>{const n=JSON.parse(JSON.stringify(B.value));let e=0;return n.forEach(a=>{a.indexOf("-")!==-1&&e++}),e}),$=b([]),te=W(()=>{const n=JSON.parse(JSON.stringify($.value));let e=0;return n.forEach(a=>{a.indexOf("-")!==-1&&e++}),e}),ve=()=>g(this,null,function*(){const n=yield O({ids:P.temporList?P.temporList:[]});T.value=n}),se=n=>g(this,null,function*(){const a=[...yield O({keyword:n})];a.forEach((o,t)=>{o.temporaryWarehouseOssList&&(o.children=o.temporaryWarehouseOssList,o.children.forEach((r,s)=>{r.subproject=`${d("moa.ats.homePage.attachedDocuments")}:${s+1}`,r.ids=r.id,r.id=`${t}${r.id}`}))}),Re(a),setTimeout(()=>{X(),H()}),R.value=a}),le=n=>g(this,null,function*(){const{record:e}=yield V({keyword:n,addTemporaryWarehouse:0}),a=[...e];a.forEach((o,t)=>{o.countList&&(o.children=o.countList,o.children.forEach((r,s)=>{r.subproject=`${d("moa.ats.homePage.attachedDocuments")}:${s+1}`,r.ids=r.id,r.id=`${t}${r.id}`}))}),Ie(a),setTimeout(()=>{X(),H()}),E.value=a}),[we,{reload:q,getSelectRows:U,expandAll:H,setTableData:Re,setSelectedRowKeys:Ee,deleteSelectRowByKey:ne,getSelectRowKeys:ie,getDataSource:Se}]=ge({columns:[{title:d("moa.ats.homePage.subproject"),dataIndex:"subproject",slots:{customRender:"subproject"},align:"left",width:400},{title:d("moa.ats.homePage.fileRealName"),dataIndex:"fileRealName",width:250,slots:{customRender:"fileRealName"},align:"left"}],maxHeight:400,api:O,afterFetch:n=>{const e=[...n];return e.forEach(a=>{a.temporaryWarehouseOssList&&(a.children=a.temporaryWarehouseOssList,a.children.forEach((o,t)=>{o.subproject=`${d("moa.ats.homePage.attachedDocuments")}:${t+1}`,o.ids=o.id,o.id=`${a.id}-${t}-${o.id}`,o.levelid=a.id,o.length=a.children.length}))}),e},bordered:!0,clickToRowSelect:!1,isTreeTable:!0,striped:!0,showTableSetting:!1,showIndexColumn:!1,canResize:!0,rowKey:"id",rowSelection:{type:"checkbox",onSelect:(n,e)=>{if(e){const a=U();let o=[];a.forEach(t=>{t.codeName&&t.codeName=="\u591A\u7EC4\u5B66"&&(o.push(t.id),t.children.forEach(r=>{o.length>0?o.some(s=>r.id.includes(s))&&o.push(r.id):o.push(r.id)})),t.code&&t.code=="\u591A\u7EC4\u5B66"&&(o.push(t.id),o.filter(s=>s.includes(t.levelid)).length==t.length&&o.push(t.levelid))}),Ee([...new Set([...o])])}else n.children&&n.children.forEach(a=>{ne(a.id)}),n.code&&n.code=="\u591A\u7EC4\u5B66"&&ne(n.levelid),pe()}}}),[_e,{reload:G,getSelectRows:Q,expandAll:X,setTableData:Ie,setSelectedRowKeys:Ne,deleteSelectRowByKey:re,getDataSource:ke,getSelectRowKeys:de}]=ge({columns:[{title:d("moa.ats.homePage.species"),dataIndex:"species",width:250,slots:{customRender:"species"},align:"left"},{title:d("moa.ats.homePage.speciesId"),dataIndex:"speciesId",slots:{customRender:"speciesId"},width:250,align:"left"},{title:d("moa.ats.homePage.genomeVersion"),dataIndex:"genomeVersion",slots:{customRender:"genomeVersion"},width:250,align:"left"},{title:d("moa.ats.homePage.fileRealName"),dataIndex:"fileRealName",slots:{customRender:"fileRealName"},width:250,align:"left"}],maxHeight:400,api:V,searchInfo:{addTemporaryWarehouse:["0"]},afterFetch:n=>{const e=[...n];return e.forEach(a=>{a.countList&&(a.children=a.countList,a.children.forEach((o,t)=>{o.speciesId=a.speciesId,o.genomeVersion=a.genomeVersion,o.subproject=`${d("moa.ats.homePage.attachedDocuments")}:${t+1}`,o.ids=o.id,o.id=`${a.id}-${t}-${o.id}`,o.levelid=a.id,o.length=a.children.length}))}),e},useSearchForm:!1,formConfig:{labelWidth:0,showActionButtonGroup:!1,schemas:[{field:"keyword",component:"Input",label:"",slot:"input",colProps:{span:5,offset:0}}],actionColOptions:{offset:14,span:10}},bordered:!0,clickToRowSelect:!1,isTreeTable:!0,striped:!0,showTableSetting:!1,showIndexColumn:!1,canResize:!0,rowKey:"id",rowSelection:{type:"checkbox",onSelect:(n,e)=>{if(e){const a=Q();let o=[];a.forEach(t=>{t.codeName&&t.codeName=="\u53C2\u8003\u6570\u636E\u96C6"&&(o.push(t.id),t.children.forEach(r=>{o.length>0?o.some(s=>r.id.includes(s))&&o.push(r.id):(console.log(" ",r.id),o.push(r.id))})),t.code&&t.code=="\u53C2\u8003\u6570\u636E\u96C6"&&(o.push(t.id),o.filter(s=>s.includes(t.levelid)).length==t.length&&o.push(t.levelid))}),Ne([...new Set([...o])])}else n.children&&n.children.forEach(a=>{re(a.id)}),n.code&&n.code=="\u53C2\u8003\u6570\u636E\u96C6"&&re(n.levelid),pe()}}}),ce=()=>g(this,null,function*(){const n=yield U(),e=yield Q(),a=[],o=[],t=[],r=[];(n.length>0||e.length>0)&&(n.forEach(p=>{p.code?o.push({multiomicsManagementId:p.multiomicsManagementId,fileId:p.ids}):p.codeName&&a.push(p.id)}),e.forEach(p=>{p.code?r.push({multiomicsManagementId:p.multiomicsManagementId,fileId:p.ids}):p.codeName&&t.push(p.id)})),console.log(" ",a),console.log(" ",o),console.log(" ",t),console.log(" ",r);const s=yield He({multiomicsManagemenIds:a,multiomicsManagemenFileIds:o,gaReferenceDataManagementIds:t,gaReferenceDataManagementFileIds:r});console.log(" ",s),s.success&&(_.success("\u5220\u9664\u6210\u529F"),G(),q())}),Fe=()=>g(this,null,function*(){(yield Ge()).success&&(_.success("\u5F53\u524D\u6587\u4EF6\u4ED3\u5DF2\u4E3A\u7A7A"),G(),q(),M.value=[],B.value=[]),R.value=yield O()}),Pe=()=>g(this,null,function*(){(yield Qe()).success&&(_.success("\u5F53\u524D\u6587\u4EF6\u4ED3\u5DF2\u4E3A\u7A7A"),G(),q(),j.value=[],$.value=[]);const{record:e}=yield V({addTemporaryWarehouse:["0"]});E.value=e}),Y=()=>g(this,null,function*(){const n=yield U(),e=yield Q();let a=[];n.forEach(i=>{i.fileRealName&&a.push(i.fileRealName)});let o=[];e.forEach(i=>{i.fileRealName&&o.push(i.fileRealName)}),a=[...new Set([...a])],o=[...new Set([...o])];let t=[];n.forEach(i=>{i.fileMd5&&t.push(i.id)}),e.forEach(i=>{i.fileRealName&&t.push(i.id)});let r=[],s=[];n.forEach(i=>{i.fileMd5&&r.push(i.multiomicsManagementId)}),e.forEach(i=>{i.fileRealName&&s.push(i.multiomicsManagementId)}),r=[...new Set([...r])],s=[...new Set([...s])];let p=[];const Z=[];n.forEach(i=>{i.fileRealName&&Z.push({multiomicsManagementId:i.multiomicsManagementId,sysOssId:i.id,rowDate:i.id,code:i.code})}),e.forEach(i=>{i.fileRealName&&Z.push({multiomicsManagementId:i.multiomicsManagementId,sysOssId:i.id,rowDate:i.id,code:i.code})});const Ce=[...new Set([...a])],Te=[...new Set([...o])];a=[...new Set([...a]),...new Set([...o])];const ee={};a.forEach(i=>{n.forEach(m=>{m.fileRealName==i&&(ee[i]=m.fullPath)}),e.forEach(m=>{m.fileRealName==i&&(ee[i]=m.publicUrl)})});const ae=[];n.forEach(i=>{if(i.fileRealName){const m={};m[i.fileRealName]=i.ids,ae.push(m)}}),e.forEach(i=>{if(i.fileRealName){const m={};m[i.fileRealName]=i.ids,ae.push(m)}}),p.push({multiomicsManagementId:Z,arr:a,sysOssId:t,bigFileid:r,bigFileids:s,arrs:o,arrOne:Ce,arrTwo:Te,FileObj:ee,fileIdContrastArr:ae}),a.length>0||o.length>0?(D.push({path:"/moa/ats/Parameter",params:{arr:a,sysOssId:t}}),console.log(" ",p),P.setmultiomicsManagementId(p)):_.error(d("moa.ats.homePage.atLeastOneFile"))}),ue=()=>g(this,null,function*(){B.value=yield ie(),$.value=yield de()}),pe=()=>{setTimeout(()=>{B.value=ie(),$.value=de()},1)};return Be(()=>g(this,null,function*(){const n=yield ze({meaning:"multiomics_analysis"});x.value=n,x.value.forEach((a,o)=>{a.label=a.name,a.value=a.code,a.key=o}),ve(),setTimeout(()=>{X(),H()},1e3),setTimeout(()=>{C.value="1"},1),R.value=yield O();const{record:e}=yield V({addTemporaryWarehouse:["0"]});E.value=e,setTimeout(()=>g(this,null,function*(){const a=yield Se(),o=yield ke();a.forEach(t=>{M.value.push(t),t.children&&t.children.length>0&&t.children.forEach(r=>{M.value.push(r)})}),o.forEach(t=>{j.value.push(t),t.children&&t.children.length>0&&t.children.forEach(r=>{j.value.push(r)})})}),3e3)})),(n,e)=>{const a=K("CustomButton"),o=K("a-tab-pane"),t=K("a-tabs"),r=K("a-card");return y(),I("div",null,[h(l(Je),{contentFullHeight:!0},{default:c(()=>[f("div",Ye,[f("div",Ze,[ea,f("div",aa,u(l(d)("moa.ats.homePage.title")),1)]),(y(!0),I($e,null,We([l(d)("moa.ats.homePage.step1"),l(d)("moa.ats.homePage.step2")],(s,p)=>(y(),A(l(qe),{currents:1,indexs:p+1,contents:s,key:s,toNextPage:[2],toNextFn:[Y]},null,8,["indexs","contents","toNextFn"]))),128))]),h(r,{style:{width:"100%",height:"100%"}},{default:c(()=>[f("div",oa,[h(t,{activeKey:C.value,"onUpdate:activeKey":e[14]||(e[14]=s=>C.value=s)},{default:c(()=>[h(o,{key:"1",tab:l(d)("moa.ats.homePage.tab1")},{default:c(()=>[f("div",ta,[N(f("h3",{style:{position:"absolute",bottom:"-5px"}},u(l(d)("moa.ats.homePage.numberFiles"))+u(l(ye))+","+u(l(d)("moa.ats.homePage.numberFilesSelected"))+u(l(oe)),513),[[k,R.value.length!=0]]),N(f("div",sa,[N(h(l(fe),{onClick:e[0]||(e[0]=()=>{Y()}),style:{background:"#3152ed",color:"#ffffff",border:"1px solid #666666",margin:"0px 0px",borderRadius:"4px"}},{default:c(()=>[F(u(l(d)("moa.ats.homePage.next")),1)]),_:1},512),[[k,R.value.length!=0]])],512),[[k,R.value.length!=0]]),h(l(be),{onRegister:l(we),onSelectionChange:e[6]||(e[6]=()=>{ue()})},{tableTitle:c(()=>[h(l(he),{allowClear:"",value:w.value,"onUpdate:value":e[1]||(e[1]=s=>w.value=s),onPressEnter:e[2]||(e[2]=()=>{se(w.value)}),style:{width:"430px",margin:"0px 0px 0px 0px"},placeholder:l(d)("moa.ats.homePage.input1"),onChange:e[3]||(e[3]=({type:s})=>{s=="click"&&se("")})},{prefix:c(()=>[h(l(me))]),_:1},8,["value","placeholder"])]),subproject:c(({record:s})=>[s.codeName=="\u591A\u7EC4\u5B66"?(y(),I("span",la,u(s.subproject),1)):(y(),I("span",na,u(s.subproject),1))]),id:c(({record:s})=>[f("div",ia,u(s.id),1)]),fileRealName:c(({record:s})=>[f("div",ra,u(s.fileRealName),1)]),toolbar:c(()=>[l(v)(["moa:temp:del"])?(y(),A(a,{key:0,size:"middle",shape:"round",style:{background:"#fff",color:"#202020",border:"1px solid #666666",borderRadius:"4px",margin:"0px 10px",width:"110px",height:"32px",lineheight:"32px"},disabled:l(oe)==0,onClick:e[4]||(e[4]=()=>{l(J)({onOk:()=>{ce()}})})},{default:c(()=>[F(u(l(d)("mom.deletes")),1)]),_:1},8,["disabled"])):L("v-if",!0),l(v)(["moa:temp:clear"])?(y(),A(a,{key:1,size:"middle",shape:"round",style:{background:"#fff",color:"#202020",border:"1px solid #666666",margin:"0px 10px 0px 0px",borderRadius:"4px",minWidth:"110px",height:"32px",lineheight:"32px"},disabled:R.value.length==0,onClick:e[5]||(e[5]=()=>{l(J)({onOk:()=>{Fe()},content:l(d)("moa.ats.homePage.confirmEmptyFileWarehouse")})})},{default:c(()=>[F(u(l(d)("moa.ats.homePage.EmptyFileWarehouse")),1)]),_:1},8,["disabled"])):L("v-if",!0)]),_:1},8,["onRegister"])])]),_:1},8,["tab"]),h(o,{key:"2",tab:l(d)("moa.ats.homePage.tab2")},{default:c(()=>[f("div",da,[N(f("h3",{style:{position:"absolute",bottom:"-5px"}},u(l(d)("moa.ats.homePage.numberFiles"))+u(l(xe))+","+u(l(d)("moa.ats.homePage.numberFilesSelected"))+u(l(te)),513),[[k,E.value.length!=0]]),N(f("div",ca,[N(h(l(fe),{onClick:e[7]||(e[7]=()=>{Y()}),style:{background:"#3152ed",color:"#ffffff",border:"1px solid #666666",margin:"0px 0px",borderRadius:"4px"}},{default:c(()=>[F(u(l(d)("moa.ats.homePage.next")),1)]),_:1},512),[[k,E.value.length!=0]])],512),[[k,E.value.length!=0]]),h(l(be),{onRegister:l(_e),onSelectionChange:e[13]||(e[13]=()=>{ue()})},{tableTitle:c(()=>[h(l(he),{allowClear:"",value:z.value,"onUpdate:value":e[8]||(e[8]=s=>z.value=s),onPressEnter:e[9]||(e[9]=()=>{le(z.value)}),onChange:e[10]||(e[10]=({type:s})=>{s=="click"&&le("")}),style:{width:"430px",margin:"0px 0px 0spx 0px"},placeholder:l(d)("moa.ats.homePage.input2")},{prefix:c(()=>[h(l(me))]),_:1},8,["value","placeholder"])]),species:c(({record:s})=>[s.codeName=="\u53C2\u8003\u6570\u636E\u96C6"?(y(),I("span",ua,u(s.species),1)):(y(),I("span",pa,u(s.subproject),1))]),speciesId:c(({record:s})=>[f("div",fa,u(s.speciesId),1)]),genomeVersion:c(({record:s})=>[f("div",ha,u(s.genomeVersion),1)]),fileRealName:c(({record:s})=>[f("div",ma,u(s.fileRealName),1)]),toolbar:c(()=>[l(v)(["moa:temp:del"])?(y(),A(a,{key:0,size:"middle",shape:"round",style:{background:"#fff",color:"#202020",border:"1px solid #666666",borderRadius:"4px",margin:"0px 10px"},disabled:l(te)==0,onClick:e[11]||(e[11]=()=>{l(J)({onOk:()=>{ce()}})})},{default:c(()=>[F(u(l(d)("mom.deletes")),1)]),_:1},8,["disabled"])):L("v-if",!0),l(v)(["moa:temp:clear"])?(y(),A(a,{key:1,size:"middle",shape:"round",style:{background:"#fff",color:"#202020",border:"1px solid #666666",margin:"0px 10px 0px 0px",borderRadius:"4px"},disabled:E.value.length==0,onClick:e[12]||(e[12]=()=>{l(J)({onOk:()=>{Pe()},content:l(d)("moa.ats.homePage.confirmEmptyFileWarehouse")})})},{default:c(()=>[F(u(l(d)("moa.ats.homePage.EmptyFileWarehouse")),1)]),_:1},8,["disabled"])):L("v-if",!0)]),_:1},8,["onRegister"])])]),_:1},8,["tab"])]),_:1},8,["activeKey"])])]),_:1})]),_:1})])}}});var Za=Ae(ga,[["__scopeId","data-v-d5fd7c22"]]);export{Za as default};

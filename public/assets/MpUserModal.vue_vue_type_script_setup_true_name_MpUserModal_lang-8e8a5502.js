import{u as I,B as h}from"./index-b6b4562f.js";import{u as b,a as w}from"./useForm-f3f06b26.js";import{f as _}from"./index-525ecc99.js";import{g as x}from"./index-9da8f773.js";import"./index-1ec106fd.js";import{u as o}from"./useRender-3355e2aa.js";import{bD as n,a as i,o as F,c as P,w as k,e as M,u as a,ag as R}from"./index-4a8cc517.js";const O=[{title:"岗位编号",dataIndex:"id",width:100},{title:"用户标识",dataIndex:"openid",width:180},{title:"昵称",dataIndex:"nickname",width:100},{title:"备注",dataIndex:"remark",width:120},{title:"标签",dataIndex:"tagIds",width:180,customRender:({text:e})=>o.renderTags(e)},{title:"订阅状态",dataIndex:"subscribeStatus",width:180,customRender:({text:e})=>o.renderTag(e===0?"已订阅":"未订阅",e===0?"purple":"orange")},{title:"订阅时间",dataIndex:"subscribeTime",width:180,customRender:({text:e})=>o.renderDate(e)}],V=[{label:"公众号",field:"accountId",component:"ApiSelect",componentProps:{api:()=>_(),labelField:"name",valueField:"id"},colProps:{span:8}},{label:"用户标识",field:"openid",component:"Input",colProps:{span:8}},{label:"昵称",field:"nickname",component:"Input",colProps:{span:8}}],S=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"昵称",field:"nickname",required:!0,component:"Input"},{label:"备注",field:"remark",required:!0,component:"Input"},{label:"标签",field:"tagIds",helpMessage:"在微信公众平台（mp.weixin.qq.com）的菜单 [设置与开发 - 公众号设置 - 基本设置] 中能找到「开发者ID(AppID)」",required:!0,component:"ApiSelect",componentProps:{api:()=>x(),labelField:"name",valueField:"tagId",mode:"tags"}}];function y(e){return n.put({url:"/mp/user/update",data:e})}function q(e){return n.get({url:"/mp/user/get?id="+e})}function $(e){return n.get({url:"/mp/user/page",params:e})}function G(e){return n.post({url:"/mp/tag/sync?accountId="+e})}const A=i({name:"MpUserModal"}),H=i({...A,emits:["success","register"],setup(e,{emit:l}){const[d,{setFieldsValue:c,resetFields:p,validate:u}]=b({labelWidth:120,baseColProps:{span:24},schemas:S,showActionButtonGroup:!1,actionColOptions:{span:23}}),[m,{setModalProps:s,closeModal:f}]=I(async t=>{p(),s({confirmLoading:!1});const r=await q(t.record.id);c({...r})});async function g(){try{const t=await u();s({confirmLoading:!0}),await y(t),f(),l("success")}finally{s({confirmLoading:!1})}}return(t,r)=>(F(),P(a(h),R(t.$attrs,{onRegister:a(m),title:"编辑",onOk:g}),{default:k(()=>[M(a(w),{onRegister:a(d)},null,8,["onRegister"])]),_:1},16,["onRegister"]))}});export{H as _,G as a,O as c,$ as g,V as s};

var ye=Object.defineProperty,Oe=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var Me=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable;var ne=(e,n,l)=>n in e?ye(e,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[n]=l,M=(e,n)=>{for(var l in n||(n={}))Me.call(n,l)&&ne(e,l,n[l]);if(te)for(var l of te(n))Fe.call(n,l)&&ne(e,l,n[l]);return e},A=(e,n)=>Oe(e,Ce(n));var z=(e,n,l)=>new Promise((r,o)=>{var c=d=>{try{a(l.next(d))}catch(u){o(u)}},t=d=>{try{a(l.throw(d))}catch(u){o(u)}},a=d=>d.done?r(d.value):Promise.resolve(d.value).then(c,t);a((l=l.apply(e,n)).next())});import{i as y,ad as ue,u as de,aE as q,j as s,ar as Se,b as T,av as He,bM as $e,bN as Be,bO as Pe,b3 as ke,r as m,bP as Le,l as F,ay as fe,q as we,bz as pe,aG as B,a as R,x as b,bk as Te,o as O,U as k,A as g,y as _e,c as V,aJ as P,aL as De,aK as Ee,bQ as Ne,w as ge,ao as Re,f as X,am as We,D as Y,t as G,B as N,bR as je,b2 as Ae,bF as U,aA as me,bn as le,ap as oe,V as ae,W as re,aI as Q,bS as ze,s as he,as as I,bT as Ie,bU as Ve,bV as be,bW as qe,bG as Ue}from"./index.10ef4608.js";import{u as Xe}from"./useAttrs.1d381a3e.js";import{u as Ye}from"./useWindowSizeFn.3e5b045d.js";import{c as Ge}from"./useModalContext.52c86736.js";var Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"},Qe=Je;function se(e){for(var n=1;n<arguments.length;n++){var l=arguments[n]!=null?Object(arguments[n]):{},r=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(l).filter(function(o){return Object.getOwnPropertyDescriptor(l,o).enumerable}))),r.forEach(function(o){Ze(e,o,l[o])})}return e}function Ze(e,n,l){return n in e?Object.defineProperty(e,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[n]=l,e}var Z=function(n,l){var r=se({},n,l.attrs);return y(ue,se({},r,{icon:Qe}),null)};Z.displayName="FullscreenExitOutlined";Z.inheritAttrs=!1;var Ke=Z,xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"},et=xe;function ie(e){for(var n=1;n<arguments.length;n++){var l=arguments[n]!=null?Object(arguments[n]):{},r=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(l).filter(function(o){return Object.getOwnPropertyDescriptor(l,o).enumerable}))),r.forEach(function(o){tt(e,o,l[o])})}return e}function tt(e,n,l){return n in e?Object.defineProperty(e,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[n]=l,e}var K=function(n,l){var r=ie({},n,l.attrs);return y(ue,ie({},r,{icon:et}),null)};K.displayName="FullscreenOutlined";K.inheritAttrs=!1;var nt=K;const{t:ce}=de(),lt={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:ce("common.cancelText")},okText:{type:String,default:ce("common.okText")},closeFunc:Function},x=Object.assign({},lt,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function ot(e){const n=(o,c)=>getComputedStyle(o)[c],l=o=>{if(!o)return;o.setAttribute("data-drag",s(e.draggable));const c=o.querySelector(".ant-modal-header"),t=o.querySelector(".ant-modal");!c||!t||!s(e.draggable)||(c.style.cursor="move",c.onmousedown=a=>{if(!a)return;const d=a.clientX,u=a.clientY,f=document.body.clientWidth,p=document.documentElement.clientHeight,h=t.offsetWidth,C=t.offsetHeight,S=t.offsetLeft,H=f-t.offsetLeft-h,$=t.offsetTop,W=p-t.offsetTop-C,L=n(t,"left"),_=n(t,"top");let D=+L,E=+_;L.includes("%")?(D=+document.body.clientWidth*(+L.replace(/%/g,"")/100),E=+document.body.clientHeight*(+_.replace(/%/g,"")/100)):(D=+L.replace(/px/g,""),E=+_.replace(/px/g,"")),document.onmousemove=function(j){let i=j.clientX-d,v=j.clientY-u;-i>S?i=-S:i>H&&(i=H),-v>$?v=-$:v>W&&(v=W),t.style.cssText+=`;left:${i+D}px;top:${v+E}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},r=()=>{const o=document.querySelectorAll(".ant-modal-wrap");for(const c of Array.from(o)){if(!c)continue;const t=n(c,"display"),a=c.getAttribute("data-drag");t!=="none"&&(a===null||s(e.destroyOnClose))&&l(c)}};q(()=>{!s(e.visible)||!s(e.draggable)||Se(()=>{r()},30)})}function at(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Pe(e)}var rt=T({name:"Modal",inheritAttrs:!1,props:x,emits:["cancel"],setup(e,{slots:n}){const{visible:l,draggable:r,destroyOnClose:o}=He(e),c=Xe();return ot({visible:l,destroyOnClose:o,draggable:r}),()=>{let t;const a=M(M({},s(c)),e);return y(Be,a,at(t=$e(n))?t:{default:()=>[t]})}}});const st={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},it=T({name:"ModalWrapper",components:{ScrollContainer:ke},inheritAttrs:!1,props:st,emits:["height-change","ext-height"],setup(e,{emit:n}){const l=m(null),r=m(null),o=m(0),c=m(0);let t=0;Ye(u.bind(null,!1)),Le(r,()=>{u()},{attributes:!0,subtree:!0}),Ge({redoModalHeight:u});const a=F(()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${s(o)}px`}));q(()=>{e.useWrapper&&u()}),fe(()=>e.fullScreen,f=>{u(),f?c.value=o.value:o.value=c.value}),we(()=>{const{modalHeaderHeight:f,modalFooterHeight:p}=e;n("ext-height",f+p)}),pe(()=>{});function d(){return z(this,null,function*(){B(()=>{var p;const f=s(l);!f||(p=f==null?void 0:f.scrollTo)==null||p.call(f,0)})})}function u(){return z(this,null,function*(){if(!e.visible)return;const f=s(l);if(!f)return;const p=f.$el.parentElement;if(!!p){p.style.padding="0",yield B();try{const h=p.parentElement&&p.parentElement.parentElement;if(!h)return;const C=getComputedStyle(h).top,S=Number.parseInt(C);let H=window.innerHeight-S*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;S<40&&(H-=26),yield B();const $=s(r);if(!$)return;yield B(),t=$.scrollHeight,e.fullScreen?o.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:o.value=e.height?e.height:t>H?H:t,n("height-change",s(o))}catch(h){console.log(h)}}})}return{wrapperRef:l,spinRef:r,spinStyle:a,scrollTop:d,setModalHeight:u}}}),ct=["loading-tip"];function ut(e,n,l,r,o,c){const t=b("ScrollContainer"),a=Te("loading");return O(),k(t,{ref:"wrapperRef"},{default:g(()=>[_e((O(),V("div",{ref:"spinRef",style:De(e.spinStyle),"loading-tip":e.loadingTip},[P(e.$slots,"default")],12,ct)),[[a,e.loading]])]),_:3},512)}var dt=R(it,[["render",ut]]);const ft=T({name:"ModalClose",components:{Tooltip:Ee,FullscreenExitOutlined:Ke,FullscreenOutlined:nt,CloseOutlined:Ne},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(e,{emit:n}){const{prefixCls:l}=ge("basic-modal-close"),{t:r}=de(),o=F(()=>[l,`${l}--custom`,{[`${l}--can-full`]:e.canFullscreen}]);function c(a){n("cancel",a)}function t(a){a==null||a.stopPropagation(),a==null||a.preventDefault(),n("fullscreen")}return{t:r,getClass:o,prefixCls:l,handleCancel:c,handleFullScreen:t}}});function pt(e,n,l,r,o,c){const t=b("FullscreenExitOutlined"),a=b("Tooltip"),d=b("FullscreenOutlined"),u=b("CloseOutlined");return O(),V("div",{class:We(e.getClass)},[e.canFullscreen?(O(),V(Re,{key:0},[e.fullScreen?(O(),k(a,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:g(()=>[y(t,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"])):(O(),k(a,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:g(()=>[y(d,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"]))],64)):X("v-if",!0),y(a,{title:e.t("component.modal.close"),placement:"bottom"},{default:g(()=>[y(u,{onClick:e.handleCancel},null,8,["onClick"])]),_:1},8,["title"])],2)}var gt=R(ft,[["render",pt]]);const mt=T({name:"BasicModalFooter",props:x,emits:["ok","cancel"],setup(e,{emit:n}){function l(o){n("ok",o)}function r(o){n("cancel",o)}return{handleOk:l,handleCancel:r}}});function ht(e,n,l,r,o,c){const t=b("a-button");return O(),V("div",null,[P(e.$slots,"insertFooter"),e.showCancelBtn?(O(),k(t,N({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:g(()=>[Y(G(e.cancelText),1)]),_:1},16,["onClick"])):X("v-if",!0),P(e.$slots,"centerFooter"),e.showOkBtn?(O(),k(t,N({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:g(()=>[Y(G(e.okText),1)]),_:1},16,["type","onClick","loading"])):X("v-if",!0),P(e.$slots,"appendFooter")])}var bt=R(mt,[["render",ht]]);const vt=T({name:"BasicModalHeader",components:{BasicTitle:je},props:{helpMessage:{type:[String,Array]},title:{type:String}},emits:["dblclick"]});function yt(e,n,l,r,o,c){const t=b("BasicTitle");return O(),k(t,{helpMessage:e.helpMessage,class:"title-color"},{default:g(()=>[Y(G(e.title?e.title:"\xA0"),1)]),_:1},8,["helpMessage"])}var Ot=R(vt,[["render",yt],["__scopeId","data-v-05de6a5a"]]);function Ct(e){const n=m(!1),l=F(()=>{const o=s(e.wrapClassName)||"";return s(n)?`fullscreen-modal ${o} `:s(o)});function r(o){o&&o.stopPropagation(),n.value=!s(n)}return{getWrapClassName:l,handleFullScreen:r,fullScreenRef:n}}const Mt=T({name:"BasicModal",components:{Modal:rt,ModalWrapper:dt,ModalClose:gt,ModalFooter:bt,ModalHeader:Ot},inheritAttrs:!1,props:x,emits:["visible-change","height-change","cancel","ok","register","update:visible"],setup(e,{emit:n,attrs:l}){const r=m(!1),o=m(null),c=m(null),{prefixCls:t}=ge("basic-modal"),a=m(0),d={setModalProps:L,emitVisible:void 0,redoModalHeight:()=>{B(()=>{s(c)&&s(c).setModalHeight()})}},u=Q();u&&n("register",d,u.uid);const f=F(()=>M(M({},e),s(o))),{handleFullScreen:p,getWrapClassName:h,fullScreenRef:C}=Ct({modalWrapperRef:c,extHeightRef:a,wrapClassName:Ae(f.value,"wrapClassName")}),S=F(()=>{const i=A(M({},s(f)),{visible:s(r),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return A(M({},i),{wrapClassName:s(h)})}),H=F(()=>{const i=A(M(M({},l),s(f)),{visible:s(r),wrapClassName:s(h)});return s(C)?U(i,["height","title"]):U(i,"title")}),$=F(()=>{if(!s(C))return s(S).height});q(()=>{r.value=!!e.visible,C.value=!!e.defaultFullscreen}),fe(()=>s(r),i=>{var v;n("visible-change",i),n("update:visible",i),u&&((v=d.emitVisible)==null||v.call(d,i,u.uid)),B(()=>{e.scrollTop&&i&&s(c)&&s(c).scrollTop()})},{immediate:!1});function W(i){return z(this,null,function*(){var v,ee;if(i==null||i.stopPropagation(),!((ee=(v=i.target)==null?void 0:v.classList)!=null&&ee.contains(t+"-close--custom"))){if(e.closeFunc&&me(e.closeFunc)){const ve=yield e.closeFunc();r.value=!ve;return}r.value=!1,n("cancel",i)}})}function L(i){o.value=ze(s(o)||{},i),Reflect.has(i,"visible")&&(r.value=!!i.visible),Reflect.has(i,"defaultFullscreen")&&(C.value=!!i.defaultFullscreen)}function _(i){n("ok",i)}function D(i){n("height-change",i)}function E(i){a.value=i}function j(i){!e.canFullscreen||(i.stopPropagation(),p(i))}return{handleCancel:W,getBindValue:H,getProps:S,handleFullScreen:p,fullScreenRef:C,getMergeProps:f,handleOk:_,visibleRef:r,omit:U,modalWrapperRef:c,handleExtHeight:E,handleHeightChange:D,handleTitleDbClick:j,getWrapperHeight:$}}});function Ft(e,n,l,r,o,c){const t=b("ModalClose"),a=b("ModalHeader"),d=b("ModalFooter"),u=b("ModalWrapper"),f=b("Modal");return O(),k(f,N(e.getBindValue,{onCancel:e.handleCancel}),le({default:g(()=>[y(u,N({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:e.footer!==void 0&&!e.footer?0:void 0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:g(()=>[P(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])]),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:g(()=>[y(t,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])])},e.$slots.title?void 0:{name:"title",fn:g(()=>[y(a,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])])},e.$slots.footer?void 0:{name:"footer",fn:g(()=>[y(d,N(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),le({_:2},[oe(Object.keys(e.$slots),p=>({name:p,fn:g(h=>[P(e.$slots,p,ae(re(h||{})))])}))]),1040,["onOk","onCancel"])])},oe(Object.keys(e.omit(e.$slots,"default")),p=>({name:p,fn:g(h=>[P(e.$slots,p,ae(re(h||{})))])}))]),1040,["onCancel"])}var St=R(Mt,[["render",Ft]]);const w=he({}),J=he({});function Lt(){const e=m(null),n=m(!1),l=m("");function r(t,a){if(!Q())throw new Error("useModal() can only be used inside setup() or functional components!");l.value=a,pe(()=>{e.value=null,n.value=!1,w[s(l)]=null}),!(s(n)&&Ve()&&t===s(e))&&(e.value=t,n.value=!0,t.emitVisible=(d,u)=>{J[u]=d})}const o=()=>{const t=s(e);return t||be("useModal instance is undefined!"),t},c={setModalProps:t=>{var a;(a=o())==null||a.setModalProps(t)},getVisible:F(()=>J[~~s(l)]),redoModalHeight:()=>{var t,a;(a=(t=o())==null?void 0:t.redoModalHeight)==null||a.call(t)},openModal:(t=!0,a,d=!0)=>{var p;if((p=o())==null||p.setModalProps({visible:t}),!a)return;const u=s(l);if(d){w[u]=null,w[u]=I(a);return}Ie(I(w[u]),I(a))||(w[u]=I(a))},closeModal:()=>{var t;(t=o())==null||t.setModalProps({visible:!1})}};return[r,c]}const wt=e=>{const n=m(null),l=Q(),r=m(""),o=()=>{const t=s(n);return t||be("useModalInner instance is undefined!"),t},c=(t,a)=>{qe(()=>{n.value=null}),r.value=a,n.value=t,l==null||l.emit("register",t,a)};return q(()=>{const t=w[s(r)];!t||!e||!me(e)||B(()=>{e(t)})}),[c,{changeLoading:(t=!0)=>{var a;(a=o())==null||a.setModalProps({loading:t})},getVisible:F(()=>J[~~s(r)]),changeOkLoading:(t=!0)=>{var a;(a=o())==null||a.setModalProps({confirmLoading:t})},closeModal:()=>{var t;(t=o())==null||t.setModalProps({visible:!1})},setModalProps:t=>{var a;(a=o())==null||a.setModalProps(t)},redoModalHeight:()=>{var a;const t=(a=o())==null?void 0:a.redoModalHeight;t&&t()}}]},Tt=Ue(St);export{Tt as B,Ke as F,nt as a,wt as b,Lt as u};

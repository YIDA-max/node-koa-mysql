var x=(m,D,g)=>new Promise((s,v)=>{var o=n=>{try{u(g.next(n))}catch(f){v(f)}},d=n=>{try{u(g.throw(n))}catch(f){v(f)}},u=n=>n.done?s(n.value):Promise.resolve(n.value).then(o,d);u((g=g.apply(m,D)).next())});import{u as q,B as W}from"./useForm.98d7b8ca.js";import{a as T,b as V,u as O,r as M,a5 as G,q as H,o as K,c as L,e as F,t as A,i as p,A as c,j as r,aK as E,I as N,X as w,D as X,ab as z,p as J,k as Q}from"./index.10ef4608.js";import{s as Y}from"./supportingPaper.267f0f46.js";import{h as k}from"./tagRender.3ec1d8de.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import"./index.b6ac86eb.js";import"./useAttrs.1d381a3e.js";/* empty css                *//* empty css                */import"./uuid.2429c801.js";import"./index.c8f8ec06.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";import"./TableAction.edf9a202.js";/* empty css                */import"./download.66a6d137.js";import"./index.504b494d.js";const Z=m=>(J("data-v-8c48145a"),m=m(),Q(),m),ee={style:{display:"flex",width:"100%"}},te=Z(()=>F("div",{style:{width:"10%",textAlign:"center",margin:"10px 0px 0px 0px"}},null,-1)),ae={style:{width:"10%",textAlign:"center",display:"flex",justifyContent:"center"}},le={style:{margin:"10px 0px 0px 0px",width:"55px",height:"30px",lineHeight:"30px",textAlign:"center",position:"relative",borderRadius:"5px",right:"16px"}},se={style:{width:"70%",display:"flex",justifyContent:"center",alignItems:"center",margin:"10px 0px 0px 0px"}},re={style:{width:"10%",textAlign:"center",margin:"10px 0px 0px 0px",position:"relative",right:"10px"}},ie=V({__name:"FilePacket",props:{arr:Array,serial:{type:Number,required:!0},SequencingType:String,eData:{type:Array,required:!0}},emits:["delete"],setup(m,{expose:D,emit:g}){const s=m,{t:v}=O(),o=Y(),d=M([]),u=G(),n=[{required:!0},{validator:(i,l)=>x(this,null,function*(){if(l){const t=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,e=/^\S*$/g,a=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(t.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!e.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!a.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26");if(l.length>20)return Promise.reject("\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E20")}else return Promise.resolve()}),trigger:"change"}],f=[{required:!0},{validator:(i,l)=>x(this,null,function*(){if(l){const t=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,e=/^\S*$/g,a=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(t.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!e.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!a.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26");if(l.length>20)return Promise.reject("\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E20")}else return Promise.resolve()}),trigger:"change"}],C=[{field:"groupName",component:"Input",slot:"groupName",label:" ",labelWidth:15,colProps:{span:3,offset:0},rules:n},{field:"sampleName",slot:"sampleName",component:"Input",label:" ",labelWidth:15,rules:f,colProps:{span:3,offset:1}},{field:"sign",slot:"sign",component:"Input",label:" ",labelWidth:15,componentProps:{style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},placeholder:" "},colProps:{span:3,offset:1}},{field:"fileName",component:"Input",label:"",slot:"fileName",colProps:{span:11,offset:1}}],B=[{field:"groupName",component:"Input",slot:"groupName",label:" ",labelWidth:15,colProps:{span:3,offset:0},rules:n},{field:"sampleName",slot:"sampleName",component:"Input",label:" ",labelWidth:15,rules:f,colProps:{span:3,offset:1}},{field:"sign",slot:"sign",component:"Input",label:" ",labelWidth:15,colProps:{span:3,offset:1}},{field:"fileName",component:"Input",label:"",slot:"fileName",colProps:{span:5,offset:1}},{field:"fileNameTwo",component:"Input",label:"",slot:"fileNameNext",colProps:{span:5,offset:1}}],I=()=>x(this,null,function*(){const i=yield R();if(i.sampleName){let l=function(e,a){let h=0;for(let b=0;b<e.length;b++)if(e[b]==a&&(h++,h>1))return!0;return!1};o.FilePacketSampleName[s.serial]=i.sampleName;const t=l(o.FilePacketSampleName,i.sampleName);_({field:"sampleName",component:"Input",label:" ",labelWidth:15,rules:[{required:!0},{validator:(e,a)=>x(this,null,function*(){if(a){const h=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,b=/^\S*$/g,U=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(h.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!b.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!U.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26");if(t)return Promise.reject("\u6837\u54C1\u91CD\u590D")}else return Promise.resolve()})}]}),setTimeout(()=>{P(["sampleName"])},100)}else o.FilePacketSampleName[s.serial]=`${new Date().getTime()}`,_({field:"sampleName",component:"Input",label:" ",labelWidth:15,rules:[{required:!0},{validator:(l,t)=>x(this,null,function*(){if(t){const e=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,a=/^\S*$/g,h=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(e.test(t))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!a.test(t))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!h.test(t))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26")}else return Promise.resolve()}),trigger:"change"}]})}),[S,{validate:P,setFieldsValue:j,getFieldsValue:R,updateSchema:_}]=q({disabled:u.params.text==="view",labelWidth:120,schemas:(s==null?void 0:s.SequencingType)!="PE"?C:B,showActionButtonGroup:!1}),y=(i,l)=>{let t=[...o.publicFilePacketOptions];for(;t.length;){const e=t.pop();i.length!==0?l?i.includes(e.label)&&(e.disabled=!1):i.includes(e.label)&&(e.disabled=!0):d.value.includes(e.label)&&(e.disabled=!1)}d.value=i},$=i=>{g("delete",i),o.FilePacketgroupName.splice(s==null?void 0:s.serial,1),d.value.forEach(l=>{var t;(t=o.publicFilePacketOptions)==null||t.forEach(e=>{l===e.label&&(e.disabled=!1)})}),d.value=[]};return H(()=>{d.value=s.eData}),D({validate:P,setFieldsValue:j}),(i,l)=>(K(),L("div",ee,[te,F("div",ae,[F("div",le,A((s==null?void 0:s.serial)+1),1)]),F("div",se,[p(r(W),{onRegister:r(S),style:{width:"100%"}},{groupName:c(({model:t,field:e})=>[p(r(E),{title:t[e]},{default:c(()=>[p(r(N),{value:t[e],"onUpdate:value":a=>t[e]=a,style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},allowClear:"",placeholder:" ",onChange:a=>{t[e]=a.target.value,a.target.value?r(o).FilePacketgroupName[s==null?void 0:s.serial]={key:s==null?void 0:s.serial,label:a.target.value,value:a.target.value}:r(o).FilePacketgroupName.splice(s==null?void 0:s.serial,1)}},null,8,["value","onUpdate:value","onChange"])]),_:2},1032,["title"])]),sampleName:c(({model:t,field:e})=>[p(r(E),{title:t[e]},{default:c(()=>[p(r(N),{value:t[e],"onUpdate:value":a=>t[e]=a,style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},allowClear:"",placeholder:" ",onBlur:l[0]||(l[0]=()=>{I()})},null,8,["value","onUpdate:value"])]),_:2},1032,["title"])]),sign:c(({model:t,field:e})=>[p(r(E),{title:t[e]},{default:c(()=>[p(r(N),{value:t[e],"onUpdate:value":a=>t[e]=a,style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},allowClear:"",placeholder:" "},null,8,["value","onUpdate:value"])]),_:2},1032,["title"])]),fileName:c(({model:t,field:e})=>[p(r(w),{ref:"select",value:t[e],"onUpdate:value":a=>t[e]=a,width:120,allowClear:"",mode:"multiple",tagRender:a=>r(k)(a,y,r(u).params.text),options:r(o).publicFilePacketOptions,onChange:l[1]||(l[1]=()=>{r(u).params.text!="view"}),getPopupContainer:a=>a.parentElement,disabled:r(u).params.text==="view"},null,8,["value","onUpdate:value","tagRender","options","getPopupContainer","disabled"])]),fileNameNext:c(({model:t,field:e})=>[p(r(w),{ref:"select",value:t[e],"onUpdate:value":a=>t[e]=a,allowClear:"",mode:"multiple",options:r(o).publicFilePacketOptions,tagRender:a=>r(k)(a,y,r(u).params.text),onChange:l[2]||(l[2]=()=>{r(u).params.text!="view"}),getPopupContainer:a=>a.parentElement,disabled:r(u).params.text==="view"},null,8,["value","onUpdate:value","options","tagRender","getPopupContainer","disabled"])]),_:1},8,["onRegister"])]),F("div",re,[p(r(z),{onClick:l[3]||(l[3]=()=>{$(s==null?void 0:s.serial)}),disabled:r(u).params.text==="view",type:"link"},{default:c(()=>[X(A(r(v)("AllMessage.delete")),1)]),_:1},8,["disabled"])])]))}});var Be=T(ie,[["__scopeId","data-v-8c48145a"]]);export{Be as default};

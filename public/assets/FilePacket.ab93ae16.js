var f=(E,N,m)=>new Promise((r,x)=>{var o=u=>{try{d(m.next(u))}catch(h){x(h)}},c=u=>{try{d(m.throw(u))}catch(h){x(h)}},d=u=>u.done?r(u.value):Promise.resolve(u.value).then(o,c);d((m=m.apply(E,N)).next())});import{u as U,B as q}from"./useForm.98d7b8ca.js";import{b as W,u as T,r as V,q as O,o as M,c as G,e as F,t as C,i as n,A as p,j as s,aK as v,I as P,X as k,D as H,ab as K}from"./index.10ef4608.js";import{h as _}from"./tagRender.3ec1d8de.js";import{s as L}from"./supportingPaper.267f0f46.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import"./index.b6ac86eb.js";import"./useAttrs.1d381a3e.js";/* empty css                *//* empty css                */import"./uuid.2429c801.js";import"./index.c8f8ec06.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";import"./TableAction.edf9a202.js";/* empty css                */import"./download.66a6d137.js";import"./index.504b494d.js";const X={style:{display:"flex",width:"100%"}},z=F("div",{style:{width:"10%",textAlign:"center",margin:"10px 0px 0px 0px"}},null,-1),J={style:{width:"10%",textAlign:"center",display:"flex",justifyContent:"center"}},Q={style:{margin:"10px 0px 0px 0px",width:"55px",height:"30px",lineHeight:"30px",textAlign:"center",position:"relative",borderRadius:"5px",right:"16px"}},Y={style:{width:"70%",display:"flex",justifyContent:"center",alignItems:"center",margin:"10px 0px 0px 0px"}},Z={style:{width:"10%",textAlign:"center",margin:"10px 0px 0px 0px",position:"relative",right:"10px"}},Pe=W({__name:"FilePacket",props:{arr:Array,serial:{type:Number,required:!0},SequencingType:String,item:Array,eData:{type:Array,required:!0}},emits:["delete"],setup(E,{expose:N,emit:m}){const r=E,{t:x}=T(),o=L(),c=V([]),d=[{required:!0},{validator:(i,a)=>f(this,null,function*(){if(a){const l=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,t=/^\S*$/g,e=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(l.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!t.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!e.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26");if(a.length>20)return Promise.reject("\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E20")}else return Promise.resolve()}),trigger:"change"}],u=[{required:!0},{validator:(i,a)=>f(this,null,function*(){if(a){const l=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,t=/^\S*$/g,e=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(l.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!t.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!e.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26");if(a.length>20)return Promise.reject("\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E20")}else return Promise.resolve()}),trigger:"change"}],h=[{field:"groupName",component:"Input",slot:"groupName",label:" ",labelWidth:15,colProps:{span:3,offset:0},rules:d},{field:"sampleName",slot:"sampleName",component:"Input",label:" ",labelWidth:15,rules:u,colProps:{span:3,offset:1}},{field:"sign",slot:"sign",component:"Input",label:" ",labelWidth:15,componentProps:{style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},placeholder:" "},colProps:{span:3,offset:1}},{field:"fileName",component:"Input",label:"",slot:"fileName",colProps:{span:11,offset:1}}],B=[{field:"groupName",component:"Input",slot:"groupName",label:" ",labelWidth:15,colProps:{span:3,offset:0},rules:d},{field:"sampleName",slot:"sampleName",component:"Input",label:" ",labelWidth:15,rules:u,colProps:{span:3,offset:1}},{field:"sign",slot:"sign",component:"Input",label:" ",labelWidth:15,colProps:{span:3,offset:1}},{field:"fileName",component:"Input",label:"",slot:"fileName",colProps:{span:5,offset:1}},{field:"fileNameTwo",component:"Input",label:"",slot:"fileNameNext",colProps:{span:5,offset:1}}],w=()=>f(this,null,function*(){const i=yield S();if(i.sampleName){let a=function(t,e){let g=0;for(let b=0;b<t.length;b++)if(t[b]==e&&(g++,g>1))return!0;return!1};o.FilePacketSampleName[r.serial]=i.sampleName;const l=a(o.FilePacketSampleName,i.sampleName);console.log(" ",l),A({field:"sampleName",component:"Input",label:" ",labelWidth:15,rules:[{required:!0},{validator:(t,e)=>f(this,null,function*(){if(e){const g=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,b=/^\S*$/g,$=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(g.test(e))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!b.test(e))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!$.test(e))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26");if(l)return Promise.reject("\u6837\u54C1\u91CD\u590D")}else return Promise.resolve()})}]}),setTimeout(()=>{y(["sampleName"])},100)}else o.FilePacketSampleName[r.serial]=`${new Date().getTime()}`,A({field:"sampleName",component:"Input",label:" ",labelWidth:15,rules:[{required:!0},{validator:(a,l)=>f(this,null,function*(){if(l){const t=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,e=/^\S*$/g,g=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(t.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!e.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!g.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26")}else return Promise.resolve()}),trigger:"change"}]})}),[j,{validate:y,setFieldsValue:I,getFieldsValue:S,updateSchema:A}]=U({labelWidth:120,schemas:(r==null?void 0:r.SequencingType)!="PE"?h:B,showActionButtonGroup:!1}),D=(i,a)=>{let l=[...o.publicFilePacketOptions];for(;l.length;){const t=l.pop();i.length!==0?a?i.includes(t.label)&&(t.disabled=!1):i.includes(t.label)&&(t.disabled=!0):c.value.includes(t.label)&&(t.disabled=!1)}c.value=i},R=i=>{m("delete",i),o.FilePacketgroupName.splice(r==null?void 0:r.serial,1),c.value.forEach(a=>{var l;(l=o.publicFilePacketOptions)==null||l.forEach(t=>{a===t.label&&(t.disabled=!1)})}),c.value=[]};return O(()=>{c.value=r.eData}),N({validate:y,setFieldsValue:I}),(i,a)=>(M(),G("div",X,[z,F("div",J,[F("div",Q,C((r==null?void 0:r.serial)+1),1)]),F("div",Y,[n(s(q),{onRegister:s(j),style:{width:"100%"}},{groupName:p(({model:l,field:t})=>[n(s(v),{title:l[t]},{default:p(()=>[n(s(P),{value:l[t],"onUpdate:value":e=>l[t]=e,style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},allowClear:"",placeholder:" ",onChange:e=>{l[t]=e.target.value,e.target.value?s(o).FilePacketgroupName[r==null?void 0:r.serial]={key:r==null?void 0:r.serial,label:e.target.value,value:e.target.value}:s(o).FilePacketgroupName.splice(r==null?void 0:r.serial,1)}},null,8,["value","onUpdate:value","onChange"])]),_:2},1032,["title"])]),sampleName:p(({model:l,field:t})=>[n(s(v),{title:l[t]},{default:p(()=>[n(s(P),{value:l[t],"onUpdate:value":e=>l[t]=e,style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},allowClear:"",placeholder:" ",onBlur:a[0]||(a[0]=()=>{w()})},null,8,["value","onUpdate:value"])]),_:2},1032,["title"])]),sign:p(({model:l,field:t})=>[n(s(v),{title:l[t]},{default:p(()=>[n(s(P),{value:l[t],"onUpdate:value":e=>l[t]=e,style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},allowClear:"",placeholder:" "},null,8,["value","onUpdate:value"])]),_:2},1032,["title"])]),fileName:p(({model:l,field:t})=>[n(s(k),{ref:"select",value:l[t],"onUpdate:value":e=>l[t]=e,width:120,allowClear:"",mode:"multiple",options:s(o).publicFilePacketOptions,getPopupContainer:e=>e.parentElement,tagRender:e=>s(_)(e,D),onChange:a[1]||(a[1]=e=>{D(e,!1)})},null,8,["value","onUpdate:value","options","getPopupContainer","tagRender"])]),fileNameNext:p(({model:l,field:t})=>[n(s(k),{ref:"select",value:l[t],"onUpdate:value":e=>l[t]=e,allowClear:"",mode:"multiple",options:s(o).publicFilePacketOptions,getPopupContainer:e=>e.parentElement,tagRender:e=>s(_)(e,D),onChange:a[2]||(a[2]=e=>{D(e,!1)})},null,8,["value","onUpdate:value","options","getPopupContainer","tagRender"])]),_:1},8,["onRegister"])]),F("div",Z,[n(s(K),{onClick:a[3]||(a[3]=()=>{R(r==null?void 0:r.serial)}),type:"link"},{default:p(()=>[H(C(s(x)("AllMessage.delete")),1)]),_:1})])]))}});export{Pe as default};

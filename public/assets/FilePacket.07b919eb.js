var m=(N,D,d)=>new Promise((s,F)=>{var o=n=>{try{g(d.next(n))}catch(h){F(h)}},x=n=>{try{g(d.throw(n))}catch(h){F(h)}},g=n=>n.done?s(n.value):Promise.resolve(n.value).then(o,x);g((d=d.apply(N,D)).next())});import{u as U,B as W}from"./useForm.98d7b8ca.js";import{b as q,u as T,r as V,q as O,o as M,c as G,e as c,t as C,i as u,A as p,j as r,aK as P,I as y,X as _,D as H,ab as K,ao as L}from"./index.10ef4608.js";import{s as X}from"./supportingPaper.267f0f46.js";import{h as k}from"./tagRender.3ec1d8de.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import"./index.b6ac86eb.js";import"./useAttrs.1d381a3e.js";/* empty css                *//* empty css                */import"./uuid.2429c801.js";import"./index.c8f8ec06.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";import"./TableAction.edf9a202.js";/* empty css                */import"./download.66a6d137.js";import"./index.504b494d.js";const z={style:{display:"flex",width:"100%"}},J=c("div",{style:{width:"10%",textAlign:"center",margin:"10px 0px 0px 0px"}},null,-1),Q={style:{width:"10%",textAlign:"center",display:"flex",justifyContent:"center"}},Y={style:{margin:"10px 0px 0px 0px",width:"55px",height:"30px",lineHeight:"30px",textAlign:"center",position:"relative",borderRadius:"5px",right:"16px"}},Z={style:{width:"70%",display:"flex",justifyContent:"center",alignItems:"center",margin:"10px 0px 0px 0px"}},ee={style:{width:"10%",textAlign:"center",margin:"10px 0px 0px 0px",position:"relative",right:"10px"}},te=c("div",{style:{position:"relative",bottom:"9px"}},[c("hr")],-1),Ce=q({__name:"FilePacket",props:{arr:Array,serial:{type:Number,required:!0},SequencingType:String},emits:["delete"],setup(N,{expose:D,emit:d}){const s=N,{t:F}=T(),o=X(),x=[{required:!0},{validator:(i,a)=>m(this,null,function*(){if(a){const l=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,t=/^\S*$/g,e=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(l.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!t.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!e.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26");if(a.length>20)return Promise.reject("\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E20")}else return Promise.resolve()}),trigger:"change"}],g=[{required:!0},{validator:(i,a)=>m(this,null,function*(){if(a){const l=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,t=/^\S*$/g,e=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(l.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!t.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!e.test(a))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26");if(a.length>20)return Promise.reject("\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E20")}else return Promise.resolve()}),trigger:"change"}],n=V([]),h=[{field:"groupName",component:"Input",slot:"groupName",label:" ",labelWidth:15,colProps:{span:3,offset:0},rules:x},{field:"sampleName",slot:"sampleName",component:"Input",label:" ",labelWidth:15,rules:g,colProps:{span:3,offset:1}},{field:"sign",slot:"sign",component:"Input",label:" ",labelWidth:15,componentProps:{style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},placeholder:" "},colProps:{span:3,offset:1}},{field:"fileName",component:"Input",label:"",slot:"fileName",colProps:{span:11,offset:1}}],B=[{field:"groupName",component:"Input",slot:"groupName",label:" ",labelWidth:15,colProps:{span:3,offset:0},rules:x},{field:"sampleName",slot:"sampleName",component:"Input",label:" ",labelWidth:15,rules:g,colProps:{span:3,offset:1}},{field:"sign",slot:"sign",component:"Input",label:" ",labelWidth:15,colProps:{span:3,offset:1}},{field:"fileName",component:"Input",label:"",slot:"fileName",colProps:{span:5,offset:1}},{field:"fileNameTwo",component:"Input",label:"",slot:"fileNameNext",colProps:{span:5,offset:1}}],w=()=>m(this,null,function*(){const i=yield S();if(i.sampleName){let a=function(t,e){let f=0;for(let b=0;b<t.length;b++)if(t[b]==e&&(f++,f>1))return!0;return!1};o.FilePacketSampleName[s.serial]=i.sampleName;const l=a(o.FilePacketSampleName,i.sampleName);A({field:"sampleName",component:"Input",label:" ",labelWidth:15,rules:[{required:!0},{validator:(t,e)=>m(this,null,function*(){if(e){const f=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,b=/^\S*$/g,$=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(f.test(e))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!b.test(e))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!$.test(e))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26");if(l)return Promise.reject("\u6837\u54C1\u91CD\u590D")}else return Promise.resolve()})}]}),setTimeout(()=>{v(["sampleName"])},100)}else o.FilePacketSampleName[s.serial]=`${new Date().getTime()}`,A({field:"sampleName",component:"Input",label:" ",labelWidth:15,rules:[{required:!0},{validator:(a,l)=>m(this,null,function*(){if(l){const t=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/g,e=/^\S*$/g,f=/^((?![\\'\\/\\*\\-\\@\\#\\$\\%\\^\\&\\(\\)\\)-]).)*$/g;if(t.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u4E2D\u6587");if(!e.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u7A7A\u683C");if(!f.test(l))return Promise.reject("\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26")}else return Promise.resolve()}),trigger:"change"}]})}),[j,{validate:v,setFieldsValue:I,getFieldsValue:S,updateSchema:A}]=U({labelWidth:120,schemas:(s==null?void 0:s.SequencingType)!="PE"?h:B,showActionButtonGroup:!1}),R=i=>{d("delete",i),o.FilePacketgroupName.splice(s==null?void 0:s.serial,1),n.value.forEach(a=>{var l;(l=o.publicFilePacketOptions)==null||l.forEach(t=>{a===t.label&&(t.disabled=!1)})}),n.value=[]},E=(i,a)=>{let l=[...o.publicFilePacketOptions];for(;l.length;){const t=l.pop();i.length!==0?a?i.includes(t.label)&&(t.disabled=!1):i.includes(t.label)&&(t.disabled=!0):n.value.includes(t.label)&&(t.disabled=!1)}n.value=i};return O(()=>{}),D({validate:v,setFieldsValue:I,setfun:()=>m(this,null,function*(){return yield v()})}),(i,a)=>(M(),G(L,null,[c("div",z,[J,c("div",Q,[c("div",Y,C((s==null?void 0:s.serial)+1),1)]),c("div",Z,[u(r(W),{onRegister:r(j),style:{width:"100%"}},{groupName:p(({model:l,field:t})=>[u(r(P),{title:l[t]},{default:p(()=>[u(r(y),{value:l[t],"onUpdate:value":e=>l[t]=e,style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},allowClear:"",placeholder:" ",onChange:e=>{l[t]=e.target.value,e.target.value?r(o).FilePacketgroupName[s==null?void 0:s.serial]={key:s==null?void 0:s.serial,label:e.target.value,value:e.target.value}:r(o).FilePacketgroupName.splice(s==null?void 0:s.serial,1)}},null,8,["value","onUpdate:value","onChange"])]),_:2},1032,["title"])]),sampleName:p(({model:l,field:t})=>[u(r(P),{title:l[t]},{default:p(()=>[u(r(y),{value:l[t],"onUpdate:value":e=>l[t]=e,style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},allowClear:"",placeholder:" ",onBlur:a[0]||(a[0]=()=>{w()})},null,8,["value","onUpdate:value"])]),_:2},1032,["title"])]),sign:p(({model:l,field:t})=>[u(r(P),{title:l[t]},{default:p(()=>[u(r(y),{value:l[t],"onUpdate:value":e=>l[t]=e,style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},allowClear:"",placeholder:" "},null,8,["value","onUpdate:value"])]),_:2},1032,["title"])]),fileName:p(({model:l,field:t})=>[u(r(_),{ref:"select",value:l[t],"onUpdate:value":e=>l[t]=e,width:120,allowClear:"",mode:"multiple",onChange:a[1]||(a[1]=e=>{E(e,!1)}),tagRender:e=>r(k)(e,E),getPopupContainer:e=>e.parentElement,options:[...r(o).publicFilePacketOptions]},null,8,["value","onUpdate:value","tagRender","getPopupContainer","options"])]),fileNameNext:p(({model:l,field:t})=>[u(r(_),{ref:"select",value:l[t],"onUpdate:value":e=>l[t]=e,allowClear:"",mode:"multiple",onChange:a[2]||(a[2]=e=>{E(e,!1)}),tagRender:e=>r(k)(e,E),getPopupContainer:e=>e.parentElement,options:r(o).publicFilePacketOptions},null,8,["value","onUpdate:value","tagRender","getPopupContainer","options"])]),_:1},8,["onRegister"])]),c("div",ee,[u(r(K),{onClick:a[3]||(a[3]=()=>{R(s==null?void 0:s.serial)}),type:"link"},{default:p(()=>[H(C(r(F)("AllMessage.delete")),1)]),_:1})])]),te],64))}});export{Ce as default};

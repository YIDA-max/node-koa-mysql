var _=(P,t,s)=>new Promise((f,h)=>{var y=e=>{try{n(s.next(e))}catch(d){h(d)}},w=e=>{try{n(s.throw(e))}catch(d){h(d)}},n=e=>e.done?f(e.value):Promise.resolve(e.value).then(y,w);n((s=s.apply(P,t)).next())});import{b as U,B as H}from"./index.c8f8ec06.js";import D from"./ChangeEmailForm.2c6a381e.js";import O from"./ChangePhoneForm.16fbea0f.js";import G from"./ChangePwdForm.c836675b.js";import{u as v,c}from"./useChangInfo.b588e1ad.js";import{b as S,u as b,v as k,l as j,j as a,r as I,o as L,c as R,i as C,A as $,B as x,cz as W,cA as z,cB as V,cC as q,cD as J,G as K}from"./index.10ef4608.js";import"./useAttrs.1d381a3e.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";/* empty css              *//* empty css               */import"./useCountDown.23082dea.js";import"./index.3b12af83.js";const Q={class:"changeModal"},la=S({__name:"ChangeInfoModal",setup(P){const{t}=b(),s=k(),{createMessage:f}=K(),{getChangeState:h}=v(),y=j(()=>({[c.CHANGE_PASSWORD]:t("sys.login.changePwd"),[c.CHANGE_BIND_EMAIL]:t("sys.login.changeBindEmail"),[c.CHANGE_EMAIL]:t("sys.login.changeEmail"),[c.CHANGE_BIND_PHONE]:t("sys.login.changeBindPhone"),[c.CHANGE_PHONE]:t("sys.login.changePhone")})[a(h)]),w=I(),n=I(),e=I(),d=I(),[M,{closeModal:E}]=U(r=>{const{payload:g}=r;w.value=g}),B=()=>{F(a(h))()};function F(r){return{[c.CHANGE_PASSWORD]:()=>_(this,null,function*(){try{if(!(yield a(d).validForm()))return!1;const{id:i}=s.getUserInfo,{oldPwd:m,newPwd:l}=a(d).formData,u=yield W({userId:i,oldPassword:m,newPassword:l});f.success(t(u.msg)),s.LoginOut()}catch(o){}}),[c.CHANGE_BIND_EMAIL]:()=>_(this,null,function*(){try{if(!(yield a(n).validForm()))return!1;const{id:i}=s.getUserInfo,{oldEmail:m,newEmail:l,code:p}=a(n).formData,N=yield z({userId:i,newMessage:l,oldMessage:m,code:p});f.success(t(N.msg)),E(),s.getUserInfoAction(),A()}catch(o){}}),[c.CHANGE_EMAIL]:()=>_(this,null,function*(){try{if(!(yield a(n).validForm()))return!1;const{id:i}=s.getUserInfo,{newEmail:m,code:l}=a(n).formData,u=yield V({userId:i,newMessage:m,code:l});f.success(t(u.msg)),E(),s.getUserInfoAction(),A()}catch(o){}}),[c.CHANGE_BIND_PHONE]:()=>_(this,null,function*(){try{if(!(yield a(e).validForm()))return!1;const{id:i}=s.getUserInfo,{newPhone:m,oldPhone:l,code:p}=a(e).formData,N=yield q({userId:i,newPhone:m,oldPhone:l,code:p});f.success(t(N.msg)),E(),s.getUserInfoAction(),A()}catch(o){}}),[c.CHANGE_PHONE]:()=>_(this,null,function*(){try{if(!(yield a(e).validForm()))return!1;const{id:i}=s.getUserInfo,{newPhone:m,code:l}=a(e).formData,u=yield J({userId:i,newPhone:m,code:l});f.success(t(u.msg)),E(),s.getUserInfoAction(),A()}catch(o){}})}[r]}const A=()=>{var r,g,o;(r=a(n))==null||r.claerForm(),(g=a(e))==null||g.claerForm(),(o=a(d))==null||o.claerForm()};return(r,g)=>(L(),R("div",Q,[C(a(H),x(r.$attrs,{onRegister:a(M),title:a(y),onOk:B,onCancel:A}),{default:$(()=>[C(D,{info:w.value,ref_key:"emailForm",ref:n},null,8,["info"]),C(O,{info:w.value,ref_key:"phoneForm",ref:e},null,8,["info"]),C(G,{ref_key:"pwdForm",ref:d},null,512)]),_:1},16,["onRegister","title"])]))}});export{la as default};

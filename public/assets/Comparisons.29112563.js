var B=(c,g,d)=>new Promise((e,v)=>{var r=s=>{try{i(d.next(s))}catch(n){v(n)}},m=s=>{try{i(d.throw(s))}catch(n){v(n)}},i=s=>s.done?e(s.value):Promise.resolve(s.value).then(r,m);i((d=d.apply(c,g)).next())});import{u as V,B as q}from"./useForm.98d7b8ca.js";import{a as j,b as R,u as U,ay as D,a5 as O,l as J,r as P,q as M,o as T,c as H,e as x,t as A,i as h,A as _,j as a,X as E,D as W,ab as X,p as z,k as K}from"./index.10ef4608.js";import{s as L}from"./supportingPaper.267f0f46.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import"./index.b6ac86eb.js";import"./useAttrs.1d381a3e.js";/* empty css                *//* empty css                */import"./uuid.2429c801.js";import"./index.c8f8ec06.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";import"./TableAction.edf9a202.js";/* empty css                */import"./download.66a6d137.js";import"./index.504b494d.js";const Q=c=>(z("data-v-2b44a6ed"),c=c(),K(),c),Y={style:{display:"flex",width:"100%"}},Z=Q(()=>x("div",{style:{width:"10%",textAlign:"center",margin:"10px 0px 0px 0px"}},null,-1)),$={style:{width:"10%",textAlign:"center",display:"flex",justifyContent:"center"}},ee={style:{margin:"10px 0px 0px 0px",width:"55px",height:"30px",borderRadius:"5px",lineHeight:"30px",textAlign:"center",position:"relative",right:"16px"}},oe={style:{width:"70%",display:"flex",justifyContent:"center",alignItems:"center",margin:"10px 0px 0px 0px"}},te={style:{width:"10%",textAlign:"center",margin:"10px 0px 0px 0px",position:"relative",right:"10px"}},re=R({__name:"Comparisons",props:{arr:Array,serial:{type:Number,required:!0},ComparisonsArr:Array},emits:["delete"],setup(c,{expose:g,emit:d}){const e=c,{t:v}=U(),r=L();D(()=>r.FilePacketgroupName,()=>{f().controlGroup&&!r.FilePacketgroupName.some(o=>o.value==f().controlGroup)&&b({controlGroup:""}),f().experienceGroup&&!r.FilePacketgroupName.some(o=>o.value==f().experienceGroup)&&b({experienceGroup:""})},{deep:!0});const m=O(),i=J(()=>Array.from(new Set(r.FilePacketgroupName.map(o=>o.value))).map(o=>r.FilePacketgroupName.find(l=>l.value===o))),s=P(!1),n=P(!1),S=P([]),[k,{validate:C,setFieldsValue:b,getFieldsValue:f,setProps:I}]=V({labelWidth:120,disabled:m.params.text==="view",schemas:[{field:"comparisonScheme",component:"Input",rules:[{required:!0}],label:"",colProps:{span:0,offset:0},componentProps:{allowClear:!1}},{field:"controlGroup",component:"Select",label:"",colProps:{span:4,offset:2},componentProps:{options:e==null?void 0:e.ComparisonsArr}},{field:"experienceGroup",component:"Select",label:"",colProps:{span:4,offset:4},componentProps:{options:e==null?void 0:e.ComparisonsArr}},{field:"breaks",component:"Input",label:"",colProps:{span:5,offset:3},componentProps:{style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},placeholder:" "}}],showActionButtonGroup:!1}),N=o=>{d("delete",o)},y=(o,l)=>B(this,null,function*(){s.value=!1,n.value=!1,r.comparisonsValue[e.serial][l]=o,r.comparisonsValue[e.serial].controlGroup==r.comparisonsValue[e.serial].experienceGroup&&(s.value=!0),u(r.comparisonsValue)&&(n.value=!0),C();function u(t){const p=JSON.parse(JSON.stringify(t)),G=new Set;for(let F of p){const w=F.controlGroup+F.experienceGroup;if(G.has(w))return!0;G.add(w)}return!1}});return M(()=>{var o;(o=e.arr)==null||o.forEach((l,u)=>{if(l){const t={value:"",label:""};t.value=l,t.label=l,S.value.push(t)}}),r.comparisonsValue[e.serial]={controlGroup:e.serial+"controlGroup",experienceGroup:e.serial+"experienceGroup"},setTimeout(()=>{I({schemas:[{field:"comparisonScheme",component:"Input",rules:[{required:!0}],label:"",colProps:{span:0,offset:0},defaultValue:e.serial+1,componentProps:{allowClear:!1}},{field:"controlGroup",component:"Select",label:"",colProps:{span:4,offset:2},slot:"controlGroup",rules:[{validator:()=>s.value?Promise.reject("\u5BF9\u7167\u7EC4\u4E0E\u5B9E\u9A8C\u7EC4\u76F8\u540C"):n.value?Promise.reject("\u5B58\u5728\u76F8\u540C\u6BD4\u8F83\u65B9\u6848"):Promise.resolve(),required:!0}],componentProps:{options:i}},{field:"experienceGroup",component:"Select",label:"",colProps:{span:4,offset:4},slot:"experienceGroup",rules:[{validator:()=>s.value?Promise.reject("\u5BF9\u7167\u7EC4\u4E0E\u5B9E\u9A8C\u7EC4\u76F8\u540C"):n.value?Promise.reject("\u5B58\u5728\u76F8\u540C\u6BD4\u8F83\u65B9\u6848"):Promise.resolve(),required:!0}],componentProps:{options:i}},{field:"breaks",component:"Input",label:"",colProps:{span:5,offset:3},componentProps:{style:{borderRadius:"5px",border:"1px solid #999999",height:"30px"},placeholder:" "}}]})},1e3)}),g({validate:C,setFieldsValue:b,getFieldsValue:f}),(o,l)=>(T(),H("div",Y,[Z,x("div",$,[x("div",ee,A((e==null?void 0:e.serial)+1),1)]),x("div",oe,[h(a(q),{onRegister:a(k),style:{width:"100%"}},{controlGroup:_(({model:u,field:t})=>[h(a(E),{value:u[t],"onUpdate:value":p=>u[t]=p,options:a(i),onChange:p=>{y(p,t)},disabled:a(m).params.text==="view"},null,8,["value","onUpdate:value","options","onChange","disabled"])]),experienceGroup:_(({model:u,field:t})=>[h(a(E),{value:u[t],"onUpdate:value":p=>u[t]=p,options:a(i),disabled:a(m).params.text==="view",onChange:p=>{y(p,t)}},null,8,["value","onUpdate:value","options","disabled","onChange"])]),_:1},8,["onRegister"])]),x("div",te,[h(a(X),{onClick:l[0]||(l[0]=()=>{N(e==null?void 0:e.serial)}),type:"link",disabled:a(m).params.text==="view"},{default:_(()=>[W(A(a(v)("AllMessage.delete")),1)]),_:1},8,["disabled"])])]))}});var Be=j(re,[["__scopeId","data-v-2b44a6ed"]]);export{Be as default};

var se=Object.defineProperty,oe=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var M=(i,e,n)=>e in i?se(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n,q=(i,e)=>{for(var n in e||(e={}))ne.call(e,n)&&M(i,n,e[n]);if(B)for(var n of B(e))ue.call(e,n)&&M(i,n,e[n]);return i},N=(i,e)=>oe(i,re(e));var m=(i,e,n)=>new Promise((s,F)=>{var x=d=>{try{h(n.next(d))}catch(E){F(E)}},c=d=>{try{h(n.throw(d))}catch(E){F(E)}},h=d=>d.done?s(d.value):Promise.resolve(d.value).then(x,c);h((n=n.apply(i,e)).next())});import{a as ie,b as le,u as de,r as R,ay as pe,a6 as me,q as ce,bz as fe,x as A,o as y,c as b,i as o,A as r,j as t,cM as I,e as g,D as L,t as D,aK as ge,al as Ce,dn as he,X as Ee,cv as U,ao as O,ap as j,U as _e,cl as w,y as De,z as Fe,aL as xe,aT as ve,d7 as Re,p as ye,k as Ae,G as be}from"./index.10ef4608.js";import{u as we,B as Se}from"./useForm.98d7b8ca.js";import{P as Pe}from"./index.8d0858e7.js";/* empty css                *//* empty css               *//* empty css               */import{u as Te}from"./useSetFrom.689ec4a2.js";import{a as Ie}from"./homePage.5560d038.js";import Le from"./index.855e10cf.js";import{u as Ue,B as ke}from"./useTable.a143d40c.js";import"./TableAction.edf9a202.js";import{S as Be}from"./add.f693dce6.js";import{l as Me,g as qe}from"./increasedData.fb1d93c6.js";import{L as Ne}from"./LinkOutlined.b4db2572.js";/* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import"./index.b6ac86eb.js";import"./useAttrs.1d381a3e.js";/* empty css                *//* empty css                */import"./uuid.2429c801.js";import"./index.c8f8ec06.js";import"./useWindowSizeFn.3e5b045d.js";import"./useModalContext.52c86736.js";/* empty css                */import"./download.66a6d137.js";import"./index.504b494d.js";/* empty css               */import"./onMountedOrActivated.0d13b2a6.js";import"./useContentViewHeight.9302814f.js";import"./CustomConfirmModal.69fd5aa9.js";import"./modal-error.7cada6d5.js";import"./upData.16fd5c96.js";import"./spark-md5.2cc5764b.js";import"./updata.d7bd895d.js";import"./icon-remark.1929ee0a.js";import"./useSortable.79752a2a.js";/* empty css                */import"./aes.1609b06a.js";const G=i=>(ye("data-v-31f9ee88"),i=i(),Ae(),i),Oe={class:"operate_btns"},je={class:"flex justify-end items-center"},Ge={class:"pr-2 flex justify-end items-center",style:{width:"120x","min-width":"120px"}},$e=G(()=>g("div",{class:"w-0 h-4"},null,-1)),ze=G(()=>g("div",{class:"w-0 h-4"},null,-1)),Ve=le({__name:"index",setup(i){const{t:e}=de(),{createMessage:n}=be(),s=Te(),F=R([]),x=R(!1),c=R([]);pe(()=>s.useRdmFileList,()=>{F.value=s.useRdmFileList},{deep:!0});const h=R(),d=R([]),E=me(),[$,{validate:z,resetFields:k,getFieldsValue:V}]=we({labelWidth:120,baseColProps:{span:10,offset:1},schemas:[{field:"species",component:"Input",label:e("rdm.increasedData.species"),rules:[{required:!0,validator:(u,a)=>m(this,null,function*(){return a?a.length>30?Promise.reject(e("AllMessage.RdmTextThree")):Promise.resolve():Promise.reject(e("AllMessage.RdmTextTwo"))}),trigger:"change"}],componentProps:{maxlength:30}},{field:"speciesId",component:"Input",label:e("rdm.increasedData.speciesId"),rules:[{required:!0,validator:(u,a)=>m(this,null,function*(){return a?a.length>30?Promise.reject(e("AllMessage.RdmTextThree")):isNaN(a)?Promise.reject(e("AllMessage.RdmTextThreeNumber")):Promise.resolve():Promise.reject(e("AllMessage.RdmTextTwo"))}),trigger:"change"}],componentProps:{maxlength:30}},{field:"genomeVersion",component:"Input",label:e("rdm.increasedData.genomeVersion"),rules:[{required:!0,validator:(u,a)=>m(this,null,function*(){return a?a.length>30?Promise.reject(e("AllMessage.RdmTextThree")):Promise.resolve():Promise.reject(e("AllMessage.RdmTextTwo"))}),trigger:"change"}],componentProps:{maxlength:30}},{field:"mappingId",component:"InputSearch",label:e("rdm.increasedData.mappingId"),colSlot:"mappingId"},{field:"remarkss",component:"Input",label:e("rdm.increasedData.remarkss"),slot:"ShareOne"}],showActionButtonGroup:!1}),J=()=>m(this,null,function*(){console.log(" ",h.value.map(u=>u.ftpPathList)),X([...h.value.map(u=>u.ftpPathList)])}),[K,{getSelectRows:W,setTableData:H,setSelectedRowKeys:X}]=Ue({columns:[{title:e("rdm.increasedData.ftpPathList"),dataIndex:"ftpPathList",slots:{customRender:"ftpPathList"},width:200},{title:e("rdm.increasedData.organismName"),dataIndex:"organismName",width:150},{title:e("rdm.increasedData.type"),dataIndex:"type",width:150}],afterFetch:u=>u,dataSource:[],bordered:!1,striped:!0,isTreeTable:!1,showIndexColumn:!1,canResize:!1,ellipsis:!0,rowKey:"ftpPathList",rowSelection:{type:"checkbox"}}),Q=ve(()=>m(this,null,function*(){const u=W(),a=yield z();console.log("output->getRow",u);const C=N(q({},a),{genomeSequences:s.useRdmUpData.\u57FA\u56E0\u7EC4\u5E8F\u5217,genomeAnnotationGffs:s.useRdmUpData.\u57FA\u56E0\u7EC4\u6CE8\u91CAgff,genomeAnnotationGtfs:s.useRdmUpData.\u57FA\u56E0\u7EC4\u6CE8\u91CAgtf,transcriptSequences:s.useRdmUpData.\u8F6C\u5F55\u672C\u5E8F\u5217,proteinSequences:s.useRdmUpData.\u86CB\u767D\u5E8F\u5217,others:s.useRdmUpData.\u5176\u4ED6\u7C7B,rawDatas:[...s.useRdmUpData.\u57FA\u56E0\u7EC4\u5E8F\u5217,...s.useRdmUpData.\u57FA\u56E0\u7EC4\u6CE8\u91CAgff,...s.useRdmUpData.\u57FA\u56E0\u7EC4\u6CE8\u91CAgtf,...s.useRdmUpData.\u8F6C\u5F55\u672C\u5E8F\u5217,...s.useRdmUpData.\u86CB\u767D\u5E8F\u5217,...s.useRdmUpData.\u5176\u4ED6\u7C7B],mappingIdSaveRequestList:u});setTimeout(()=>m(this,null,function*(){const v=yield Ie(C);v.success?(n.success(e("AllMessage.RdmMessageSuccessTwo")),E("/rdm"),k(),s.ResetUseRdmUpData()):(n.error(v.msg),E("/rdm"),k(),s.ResetUseRdmUpData())}),100)}),1e3),Y=()=>m(this,null,function*(){c.value=[];const u=V();if(u.mappingId||n.error(e("AllMessage.RdmMessageError")),!u.mappingId)return;x.value=!0;const{token:a,tokenKey:C}=yield Me(),S=yield[...new Set([...u.mappingId.split(",")])].map(l=>m(this,null,function*(){return yield qe({assembly_accession:l,token:a,tokenKey:C})})),P=yield Promise.all(S);if(x.value=!1,P.forEach(l=>{const{ftpPath:p,ftpPathList:f,organismName:T,seqRelDate:Z,subLibrary:ee}=l[0],te=f.map(_=>{const ae=_.indexOf("genomic.fna")!==-1?"\u57FA\u56E0\u7EC4\u5E8F\u5217":_.indexOf("genomic.gff")!==-1?"\u57FA\u56E0\u7EC4\u6CE8\u91CAgff":_.indexOf("genomic.gtf")!==-1?"\u57FA\u56E0\u7EC4\u6CE8\u91CAgtf":_.indexOf("rna.fna")!==-1?"\u8F6C\u5F55\u7EC4\u5E8F\u5217":_.indexOf("genomic.faa")!==-1?"\u86CB\u767D\u5E8F\u5217":"\u5176\u4ED6\u7C7B";return{seqRelDate:Z,subLibrary:ee,organismName:T,ftpPath:p,ftpPathList:_,type:ae}});c.value=[...c.value,...te]}),c.value.length==0){Re.error(e("AllMessage.RdmMessageErrorTwo"));return}h.value=[...JSON.parse(JSON.stringify(c.value))],H([...JSON.parse(JSON.stringify(c.value))])});return ce(()=>m(this,null,function*(){const u=yield Be();d.value=u,d.value.forEach((a,C)=>{a.label=a.nickname,a.value=a.id,a.key=C}),s.useRdmFileList=[],s.useRdmUpData={\u57FA\u56E0\u7EC4\u5E8F\u5217:[],\u57FA\u56E0\u7EC4\u6CE8\u91CAgff:[],\u57FA\u56E0\u7EC4\u6CE8\u91CAgtf:[],\u8F6C\u5F55\u672C\u5E8F\u5217:[],\u86CB\u767D\u5E8F\u5217:[],\u5176\u4ED6\u7C7B:[]}})),fe(()=>{s.useRdmFileList=[],s.useRdmUpData={\u57FA\u56E0\u7EC4\u5E8F\u5217:[],\u57FA\u56E0\u7EC4\u6CE8\u91CAgff:[],\u57FA\u56E0\u7EC4\u6CE8\u91CAgtf:[],\u8F6C\u5F55\u672C\u5E8F\u5217:[],\u86CB\u767D\u5E8F\u5217:[],\u5176\u4ED6\u7C7B:[]}}),(u,a)=>{const C=A("a-button"),v=A("a-form-item"),S=A("a-typography-text"),P=A("CustomButton");return y(),b("div",null,[o(t(Pe),{class:"high-form"},{default:r(()=>[o(t(I),{title:t(e)("rdm.increasedData.title"),bordered:!1},{extra:r(()=>[g("div",Oe,[o(C,{onClick:a[0]||(a[0]=()=>{t(E)("/rdm"),t(s).useRdmFileList=[]}),style:{color:"#202020",border:"1px solid #666"}},{default:r(()=>[L(D(t(e)("rdm.increasedData.cancel")),1)]),_:1}),o(C,{type:"primary",onClick:t(Q),style:{background:"#2d54ec",color:"#fff",marginLeft:"20px"}},{default:r(()=>[L(D(t(e)("rdm.increasedData.submit")),1)]),_:1},8,["onClick"])])]),default:r(()=>[o(t(Se),{onRegister:t($)},{mappingId:r(({model:l,field:p})=>[o(v,null,{default:r(()=>[g("div",je,[g("div",Ge,[o(t(ge),{placement:"top"},{title:r(()=>[g("span",null,D(t(e)("AllMessage.RdmTextone")),1)]),default:r(()=>[o(t(Ce),{icon:"ant-design:question-circle-filled",size:16,color:"#c2c1c1"})]),_:1}),g("span",null,D(t(e)("rdm.increasedData.mappingId")),1)]),o(t(he),{value:l[p],"onUpdate:value":f=>l[p]=f,onSearch:Y,loading:x.value},null,8,["value","onUpdate:value","loading"])])]),_:2},1024)]),ShareOne:r(({model:l,field:p})=>[o(t(Ee),{ref:"select",value:l[p],"onUpdate:value":f=>l[p]=f,allowClear:"",mode:"multiple",options:d.value,placeholder:t(e)("common.chooseText"),getPopupContainer:f=>f.parentNode},null,8,["value","onUpdate:value","options","placeholder","getPopupContainer"])]),_:1},8,["onRegister"])]),_:1},8,["title"]),$e,o(t(I),{title:t(e)("rdm.increasedData.titleTwo")},{default:r(()=>[o(t(U),null,{default:r(()=>[(y(!0),b(O,null,j([`${t(e)("rdm.increasedData.genomeSequences")}`,`${t(e)("rdm.increasedData.genomeAnnotationGffs")}`,`${t(e)("rdm.increasedData.genomeAnnotationGtfs")}`,`${t(e)("rdm.increasedData.transcriptSequences")}`,`${t(e)("rdm.increasedData.proteinSequences")}`,`${t(e)("rdm.increasedData.others")}`],(l,p)=>(y(),_e(t(w),{span:10,offset:2,key:l,style:{margin:"15px"}},{default:r(()=>[o(Le,{title:l,toindex:p},null,8,["title","toindex"]),o(t(U),null,{default:r(()=>[o(t(w),{span:6,offset:0},{default:r(()=>[(y(!0),b(O,null,j(F.value[p],(f,T)=>(y(),b("div",{style:{width:"427px",height:"36px",lineHeight:"36px",background:"#EDEEF5",borderRadius:"4px",margin:"10px 0",color:"#6387f3"},key:T},[o(t(U),null,{default:r(()=>[o(t(w),{span:1},{default:r(()=>[o(t(Ne))]),_:1}),o(t(w),{span:20},{default:r(()=>[o(S,{style:{width:"100%",color:"#6387f3"},ellipsis:!0,content:f.name},null,8,["content"])]),_:2},1024)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["title"]),ze,De(g("div",null,[o(t(I),{title:t(e)("rdm.increasedData.titleThree")},{default:r(()=>[o(t(ke),{onRegister:t(K)},{toolbar:r(()=>[o(P,{size:"middle",type:"primary",style:xe([{background:"#fff",color:"#202020",border:"1px solid #666666",borderRadius:"4px",margin:"0px 10px"}]),onClick:a[1]||(a[1]=()=>{J()})},{default:r(()=>[L(D(t(e)("AllMessage.visual.two.ExcelDisplay.ColFilter.all")),1)]),_:1})]),ftpPathList:r(({record:l})=>[g("div",null,D(l.ftpPathList.slice(l.ftpPathList.lastIndexOf("/")+1)),1)]),_:1},8,["onRegister"])]),_:1},8,["title"])],512),[[Fe,c.value.length>0]])]),_:1})])}}});var Mt=ie(Ve,[["__scopeId","data-v-31f9ee88"]]);export{Mt as default};
